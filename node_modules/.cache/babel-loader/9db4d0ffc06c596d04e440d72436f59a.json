{"ast":null,"code":"import _classCallCheck from\"C:/Users/TheTOP/Documents/GitHub/pizza-chatbot-chk4/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/TheTOP/Documents/GitHub/pizza-chatbot-chk4/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _classPrivateFieldLooseBase from\"C:/Users/TheTOP/Documents/GitHub/pizza-chatbot-chk4/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classPrivateFieldLooseBase\";import _classPrivateFieldLooseKey from\"C:/Users/TheTOP/Documents/GitHub/pizza-chatbot-chk4/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classPrivateFieldLooseKey\";import{lookup,lookupByCoords}from'zipcodes';import stores from'../resources/stores.json';var _geo=_classPrivateFieldLooseKey(\"geo\");var _user=_classPrivateFieldLooseKey(\"user\");var _store=_classPrivateFieldLooseKey(\"store\");var _search=_classPrivateFieldLooseKey(\"search\");var _prevObj=_classPrivateFieldLooseKey(\"prevObj\");var Location=/*#__PURE__*/function(){function Location(){_classCallCheck(this,Location);Object.defineProperty(this,_geo,{writable:true,value:null});Object.defineProperty(this,_user,{writable:true,value:null});Object.defineProperty(this,_store,{writable:true,value:null});Object.defineProperty(this,_search,{writable:true,value:null});Object.defineProperty(this,_prevObj,{writable:true,value:null});this.storeInfo=this.storeInfo.bind(this);this.initLoc=this.initLoc.bind(this);this.resolveGeoLoc=this.resolveGeoLoc.bind(this);this.resetLoc=this.resetLoc.bind(this);_classPrivateFieldLooseBase(this,_geo)[_geo]={isResolved:false,entryErr:false,errMsg:'',zip:'',cityState:''};_classPrivateFieldLooseBase(this,_user)[_user]={isResolved:false,entryErr:false,errMsg:'',zip:'',cityState:''};_classPrivateFieldLooseBase(this,_store)[_store]={current:'0',previous:'0'};_classPrivateFieldLooseBase(this,_search)[_search]={step:'search',method:'',searchLoc:'',isResolved:false,hasErr:false,errMsg:''};}_createClass(Location,[{key:\"ChangeLoc\",value:function ChangeLoc(){_classPrivateFieldLooseBase(this,_prevObj)[_prevObj]={user:_classPrivateFieldLooseBase(this,_user)[_user],store:_classPrivateFieldLooseBase(this,_store)[_store],search:_classPrivateFieldLooseBase(this,_search)[_search]};_classPrivateFieldLooseBase(this,_user)[_user].isResolved=false;_classPrivateFieldLooseBase(this,_user)[_user].entryErr=false;_classPrivateFieldLooseBase(this,_user)[_user].errMsg='';_classPrivateFieldLooseBase(this,_user)[_user].zip='';_classPrivateFieldLooseBase(this,_user)[_user].cityState='';_classPrivateFieldLooseBase(this,_store)[_store].previous=_classPrivateFieldLooseBase(this,_store)[_store].current;_classPrivateFieldLooseBase(this,_store)[_store].current=0;_classPrivateFieldLooseBase(this,_search)[_search].step='search';_classPrivateFieldLooseBase(this,_search)[_search].method='';_classPrivateFieldLooseBase(this,_search)[_search].searchLoc='';_classPrivateFieldLooseBase(this,_search)[_search].isResolved=false;_classPrivateFieldLooseBase(this,_search)[_search].hasErr=false;_classPrivateFieldLooseBase(this,_search)[_search].errMsg='';}},{key:\"resetLoc\",value:function resetLoc(){_classPrivateFieldLooseBase(this,_user)[_user]={isResolved:false,entryErr:false,errMsg:'',zip:'',cityState:''};_classPrivateFieldLooseBase(this,_store)[_store]={current:'0',previous:'0',didChange:false};_classPrivateFieldLooseBase(this,_search)[_search]={step:'search',method:'',searchLoc:'',isResolved:false,hasErr:false,errMsg:''};}},{key:\"storeInfo\",value:function storeInfo(i){var s=i!==0?stores.stores.find(function(r){return r.id===i;}):false;if(!s||s===undefined){return{storeName:'Please select a Store',storeHours:null,storeChange:null};}else{return s;}}},{key:\"initLoc\",value:function initLoc(){var _this=this;return this.resolveGeoLoc().then(function(data){if(data!=='GeoFail'&&(data!==null||data!=='')){var c=data.city;var s=data.state;_classPrivateFieldLooseBase(_this,_geo)[_geo]={zip:data.zip,cityState:c+', '+s,isResolved:true,entryErr:false,errMsg:''};}else if(data==='GeoFail'){_classPrivateFieldLooseBase(_this,_geo)[_geo]={zip:'',cityState:'',isResolved:true,entryErr:true,errMsg:'Geo Location is Disabled'};}else{_classPrivateFieldLooseBase(_this,_geo)[_geo]={zip:'',cityState:'',isResolved:false,entryErr:true,errMsg:'Geo Location not resolved'};}return _this;});}},{key:\"resolveGeoLoc\",value:function resolveGeoLoc(){var locOpt={timeout:5000,maximumAge:0};return new Promise(function(resolve,reject){if(\"geolocation\"in navigator){navigator.geolocation.getCurrentPosition(function(position){var lat=position.coords.latitude;var long=position.coords.longitude;var tZip=lookupByCoords(lat,long);resolve(tZip);},function(error){console.log('Error getting location');console.error(\"Error Code = \"+error.code+\" - \"+error.message);var response='GeoFail';resolve(response);},locOpt);}},function(){console.log(\"Promise reject\");});}},{key:\"searchStep\",get:function get(){return _classPrivateFieldLooseBase(this,_search)[_search].step;}},{key:\"geoZip\",get:function get(){if(_classPrivateFieldLooseBase(this,_geo)[_geo].isResolved&&!_classPrivateFieldLooseBase(this,_geo)[_geo].entryErr){return _classPrivateFieldLooseBase(this,_geo)[_geo].zip;}else{return'NoGeo';}}},{key:\"geoCityState\",get:function get(){if(_classPrivateFieldLooseBase(this,_geo)[_geo].isResolved&&!this.geoErr){return _classPrivateFieldLooseBase(this,_geo)[_geo].cityState;}else{return'Geo Location Error';}}},{key:\"geoErr\",get:function get(){return _classPrivateFieldLooseBase(this,_geo)[_geo].entryErr;}},{key:\"geoErrMsg\",get:function get(){return this.geoErr?_classPrivateFieldLooseBase(this,_geo)[_geo].errMsg:'';}},{key:\"userZip\",set:function set(val){var z=val.trim();var r=false;var e=false;var m='';var cs='';var l=lookup(z);if(typeof l!==\"undefined\"){var c=l.city;var s=l.state;r=true;cs=c+', '+s;}else{//invalid zip code\nz='';r=false;e=true;m='Enter a Valid US Zip Code';}_classPrivateFieldLooseBase(this,_user)[_user]={isResolved:r,entryErr:e,errMsg:m,zip:z,cityState:cs};},get:function get(){if(_classPrivateFieldLooseBase(this,_user)[_user].isResolved&&!_classPrivateFieldLooseBase(this,_user)[_user].entryErr){return _classPrivateFieldLooseBase(this,_user)[_user].zip;}else{return'NoUser';}}},{key:\"userCityState\",get:function get(){if(_classPrivateFieldLooseBase(this,_user)[_user].isResolved&&!this.userErr){return _classPrivateFieldLooseBase(this,_user)[_user].cityState;}else{return'User Entry Error';}}},{key:\"userErr\",get:function get(){return _classPrivateFieldLooseBase(this,_user)[_user].entryErr;}},{key:\"userErrMsg\",get:function get(){return this.userErr?_classPrivateFieldLooseBase(this,_user)[_user].errMsg:'';}},{key:\"storeLoc\",set:function set(val){var c=_classPrivateFieldLooseBase(this,_store)[_store].current;var p=_classPrivateFieldLooseBase(this,_store)[_store].previous;if(p!==0&&val===p){_classPrivateFieldLooseBase(this,_search)[_search].step='done';_classPrivateFieldLooseBase(this,_user)[_user]=_classPrivateFieldLooseBase(this,_prevObj)[_prevObj].user;_classPrivateFieldLooseBase(this,_store)[_store]=_classPrivateFieldLooseBase(this,_prevObj)[_prevObj].store;_classPrivateFieldLooseBase(this,_search)[_search]=_classPrivateFieldLooseBase(this,_prevObj)[_prevObj].search;_classPrivateFieldLooseBase(this,_prevObj)[_prevObj]=null;}else if(c!==val){_classPrivateFieldLooseBase(this,_search)[_search].step='done';_classPrivateFieldLooseBase(this,_store)[_store].current=val;_classPrivateFieldLooseBase(this,_store)[_store].previous=0;_classPrivateFieldLooseBase(this,_prevObj)[_prevObj]=null;}}},{key:\"curStoreID\",get:function get(){return _classPrivateFieldLooseBase(this,_store)[_store].current;}},{key:\"prevStoreID\",get:function get(){return _classPrivateFieldLooseBase(this,_store)[_store].previous;}},{key:\"curStoreInfo\",get:function get(){var i=_classPrivateFieldLooseBase(this,_store)[_store].current;return this.storeInfo(i);}},{key:\"prevStoreInfo\",get:function get(){var i=_classPrivateFieldLooseBase(this,_store)[_store].previous;return this.storeInfo(i);}},{key:\"searchErr\",get:function get(){return _classPrivateFieldLooseBase(this,_search)[_search].hasErr;}},{key:\"searchErrMsg\",get:function get(){return this.searchErr?_classPrivateFieldLooseBase(this,_search)[_search].errMsg:'';}},{key:\"searchMeth\",get:function get(){if(_classPrivateFieldLooseBase(this,_search)[_search].isResolved){return _classPrivateFieldLooseBase(this,_search)[_search].method;}return'No Search';}},{key:\"searchLoc\",get:function get(){if(_classPrivateFieldLooseBase(this,_search)[_search].isResolved){return _classPrivateFieldLooseBase(this,_search)[_search].searchLoc;}return'No Search';}},{key:\"search\",set:function set(values){_classPrivateFieldLooseBase(this,_search)[_search].step=values.step;_classPrivateFieldLooseBase(this,_search)[_search].method=values.method;_classPrivateFieldLooseBase(this,_search)[_search].searchLoc=values.loc;_classPrivateFieldLooseBase(this,_search)[_search].isResolved=values.res;_classPrivateFieldLooseBase(this,_search)[_search].hasErr=values.err;_classPrivateFieldLooseBase(this,_search)[_search].errMsg=values.errMsg;}},{key:\"storeSearch\",set:function set(method){var values={step:'select',method:method.method,loc:'',res:false,err:false,errMsg:''};if(values.method==='User Entry'){this.userZip=method.usrStr;if(this.userErr){values.step='search';values.method='';values.err=true;values.errMsg='Invalid Zip Entry';}else{values.loc=this.userCityState;values.res=true;}}else if(values.method==='Geo Locate'){if(this.geoErr){values.step='search';values.method='';values.err=true;values.errMsg='Invalid Geo Location';}else{values.loc=this.geoCityState;values.res=true;}}else{values.step='search';values.method='';values.err=true;values.errMsg='Invalid Search Method';}this.search=values;}}]);return Location;}();export default Location;","map":{"version":3,"sources":["C:/Users/TheTOP/Documents/GitHub/pizza-chatbot-chk4/src/components/Location.jsx"],"names":["lookup","lookupByCoords","stores","Location","storeInfo","bind","initLoc","resolveGeoLoc","resetLoc","isResolved","entryErr","errMsg","zip","cityState","current","previous","step","method","searchLoc","hasErr","user","store","search","didChange","i","s","find","r","id","undefined","storeName","storeHours","storeChange","then","data","c","city","state","locOpt","timeout","maximumAge","Promise","resolve","reject","navigator","geolocation","getCurrentPosition","position","lat","coords","latitude","long","longitude","tZip","error","console","log","code","message","response","geoErr","val","z","trim","e","m","cs","l","userErr","p","searchErr","values","loc","res","err","userZip","usrStr","userCityState","geoCityState"],"mappings":"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","sourcesContent":["import {lookup,lookupByCoords} from 'zipcodes';\r\nimport stores from '../resources/stores.json';\r\n\r\nclass Location {\r\n  #geo = null;\r\n  #user = null;\r\n  #store = null;\r\n  #search = null;\r\n  #prevObj = null;\r\n  constructor(){\r\n    this.storeInfo = this.storeInfo.bind(this);\r\n    this.initLoc = this.initLoc.bind(this);\r\n    this.resolveGeoLoc = this.resolveGeoLoc.bind(this);\r\n    this.resetLoc = this.resetLoc.bind(this);    \r\n    this.#geo = {\r\n      isResolved: false,\r\n      entryErr: false,\r\n      errMsg: '',\r\n      zip: '',\r\n      cityState: ''};     \r\n    this.#user = {\r\n      isResolved: false,\r\n      entryErr: false,\r\n      errMsg: '',\r\n      zip: '',\r\n      cityState: ''};  \r\n    this.#store = {\r\n      current: '0',\r\n      previous: '0'};\r\n    this.#search = {\r\n      step:'search',\r\n      method: '',\r\n      searchLoc: '',\r\n      isResolved: false,\r\n      hasErr: false,\r\n      errMsg: '',\r\n    }\r\n  }\r\n  get searchStep(){\r\n    return this.#search.step;\r\n  }\r\n  ChangeLoc(){\r\n    this.#prevObj = {\r\n      user:this.#user,\r\n      store:this.#store,\r\n      search:this.#search,\r\n      }   \r\n    this.#user.isResolved=false;\r\n    this.#user.entryErr=false;\r\n    this.#user.errMsg='';\r\n    this.#user.zip='';\r\n    this.#user.cityState='';            \r\n    this.#store.previous=this.#store.current;\r\n    this.#store.current = 0;     \r\n    this.#search.step='search';\r\n    this.#search.method='';\r\n    this.#search.searchLoc='';\r\n    this.#search.isResolved=false;\r\n    this.#search.hasErr=false;\r\n    this.#search.errMsg='';    \r\n  }\r\n  resetLoc(){\r\n    this.#user = {\r\n      isResolved: false,\r\n      entryErr: false,\r\n      errMsg: '',\r\n      zip: '',\r\n      cityState: ''};  \r\n    this.#store = {\r\n      current: '0',\r\n      previous: '0',      \r\n      didChange: false};\r\n    this.#search = {\r\n      step:'search',\r\n      method: '',\r\n      searchLoc: '',\r\n      isResolved: false,\r\n      hasErr: false,\r\n      errMsg: '',\r\n    } \r\n  }  \r\n  get geoZip() {\r\n    if(this.#geo.isResolved && !this.#geo.entryErr) {\r\n      return this.#geo.zip;\r\n    } else {\r\n      return 'NoGeo';\r\n    }\r\n  } \r\n  get geoCityState(){\r\n    if(this.#geo.isResolved && !this.geoErr) {\r\n      return this.#geo.cityState;\r\n    } else {\r\n      return 'Geo Location Error';\r\n    }   \r\n  }\r\n  get geoErr(){\r\n    return this.#geo.entryErr;\r\n  }\r\n  get geoErrMsg(){\r\n    return this.geoErr?this.#geo.errMsg:'';\r\n  }\r\n  set userZip(val){\r\n    let z = val.trim();    \r\n    let r = false;\r\n    let e = false;\r\n    let m = '';\r\n    let cs = '';\r\n    const l = lookup(z);\r\n    if(typeof l !==\"undefined\"){\r\n      const c = l.city;\r\n      const s = l.state;        \r\n      r = true;        \r\n      cs = c + ', ' + s;\r\n    } else {\r\n      //invalid zip code\r\n      z = '';  \r\n      r = false;\r\n      e = true;\r\n      m = 'Enter a Valid US Zip Code';        \r\n    }   \r\n    this.#user = {\r\n      isResolved: r,\r\n      entryErr: e,\r\n      errMsg: m,\r\n      zip: z,\r\n      cityState: cs,\r\n    };\r\n  }\r\n  get userZip() {\r\n    if(this.#user.isResolved && !this.#user.entryErr) {\r\n      return this.#user.zip;\r\n    } else {\r\n      return 'NoUser';\r\n    }\r\n  } \r\n  get userCityState(){\r\n    if(this.#user.isResolved && !this.userErr) {\r\n      return this.#user.cityState;\r\n    } else {\r\n      return 'User Entry Error';\r\n    }   \r\n  }\r\n  get userErr(){\r\n    return this.#user.entryErr;\r\n  }\r\n  get userErrMsg(){\r\n    return this.userErr?this.#user.errMsg:'';\r\n  }\r\n  set storeLoc(val){\r\n    const c = this.#store.current;\r\n    const p = this.#store.previous;\r\n    if(p!==0&&val===p){\r\n      this.#search.step='done';\r\n      this.#user=this.#prevObj.user;\r\n      this.#store=this.#prevObj.store;\r\n      this.#search=this.#prevObj.search;\r\n      this.#prevObj=null;\r\n    } else if(c!==val){\r\n      this.#search.step='done';      \r\n      this.#store.current = val;\r\n      this.#store.previous = 0;\r\n      this.#prevObj=null;\r\n    }    \r\n  }\r\n  get curStoreID(){\r\n    return this.#store.current;\r\n  }\r\n  get prevStoreID(){\r\n    return this.#store.previous;\r\n  }\r\n  get curStoreInfo(){\r\n    const i = this.#store.current; \r\n    return this.storeInfo(i);\r\n  }\r\n  get prevStoreInfo(){\r\n    const i = this.#store.previous; \r\n    return this.storeInfo(i);\r\n  }\r\n  get searchErr(){\r\n    return this.#search.hasErr;    \r\n  }\r\n  get searchErrMsg(){\r\n      return this.searchErr?this.#search.errMsg:'';\r\n  }\r\n  get searchMeth(){\r\n    if(this.#search.isResolved){\r\n      return this.#search.method;\r\n    }\r\n    return 'No Search'\r\n  }\r\n  get searchLoc(){\r\n    if(this.#search.isResolved){\r\n      return this.#search.searchLoc;\r\n    }\r\n    return 'No Search'\r\n  }\r\n  set search(values){\r\n    this.#search.step = values.step;\r\n    this.#search.method = values.method;\r\n    this.#search.searchLoc = values.loc;\r\n    this.#search.isResolved = values.res;\r\n    this.#search.hasErr= values.err;\r\n    this.#search.errMsg= values.errMsg;\r\n  }\r\n  set storeSearch(method){        \r\n    let values ={\r\n      step:'select',\r\n      method: method.method,\r\n      loc: '',\r\n      res: false,\r\n      err: false,\r\n      errMsg: '',\r\n    };\r\n    if(values.method==='User Entry'){\r\n      this.userZip = method.usrStr;\r\n      if(this.userErr){\r\n        values.step ='search';\r\n        values.method = '';\r\n        values.err= true;\r\n        values.errMsg= 'Invalid Zip Entry';\r\n      } else {\r\n        values.loc = this.userCityState;\r\n        values.res = true;\r\n      }\r\n    } else if(values.method==='Geo Locate'){\r\n      if(this.geoErr){\r\n        values.step ='search';\r\n        values.method = '';\r\n        values.err= true;\r\n        values.errMsg= 'Invalid Geo Location';\r\n      } else {\r\n        values.loc = this.geoCityState;\r\n        values.res = true;\r\n      }\r\n    } else {\r\n      values.step ='search';\r\n      values.method = '';\r\n      values.err= true;\r\n      values.errMsg= 'Invalid Search Method';\r\n    }\r\n    this.search = values;    \r\n  }\r\n  storeInfo(i){    \r\n    const s = i!==0?stores.stores.find(\r\n      (r) => {return r.id === i;}\r\n    ):false;\r\n    if(!s||s===undefined){\r\n      return {\r\n        storeName:'Please select a Store',\r\n        storeHours:null,\r\n        storeChange:null,\r\n      }\r\n    } else {\r\n      return s;\r\n    }    \r\n  }\r\n  initLoc() {\r\n    return (this.resolveGeoLoc()\r\n      .then(data => {\r\n        if (data!=='GeoFail' && (data!==null||data!=='')) {\r\n          const c = data.city;\r\n          const s = data.state;\r\n          this.#geo = {\r\n            zip: data.zip,\r\n            cityState: c + ', ' + s,\r\n            isResolved: true,\r\n            entryErr: false,\r\n            errMsg: '',\r\n          };      \r\n        } else if (data==='GeoFail') {\r\n          this.#geo = {\r\n            zip: '',\r\n            cityState: '',\r\n            isResolved: true,\r\n            entryErr: true,\r\n            errMsg: 'Geo Location is Disabled',\r\n          };\r\n        } else {\r\n          this.#geo = {\r\n            zip: '',\r\n            cityState: '',\r\n            isResolved: false,\r\n            entryErr: true,\r\n            errMsg: 'Geo Location not resolved',\r\n          };\r\n        }\r\n        return this;\r\n      })\r\n    )\r\n  }  \r\n  resolveGeoLoc(){ \r\n    const locOpt = {\r\n      timeout: 5000,\r\n      maximumAge: 0\r\n    };    \r\n    return (new Promise((resolve, reject) => {\r\n      if(\"geolocation\" in navigator) {\r\n        navigator.geolocation.getCurrentPosition((position) => {\r\n          let lat = position.coords.latitude;\r\n          let long = position.coords.longitude;\r\n          const tZip = lookupByCoords(lat,long);                  \r\n          resolve(tZip);\r\n        },(error) => {\r\n          console.log('Error getting location');\r\n          console.error(\"Error Code = \" + error.code + \" - \" + error.message);\r\n          const response = 'GeoFail';\r\n\r\n          resolve(response);  \r\n        },locOpt);\r\n      }\r\n    }, ()=>{\r\n      console.log(\"Promise reject\");   \r\n      }\r\n    ))        \r\n  }\r\n}\r\n\r\nexport default Location;"]},"metadata":{},"sourceType":"module"}