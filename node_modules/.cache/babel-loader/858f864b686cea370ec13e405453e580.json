{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\TheTOP\\\\Documents\\\\GitHub\\\\pizza-chatbot-chk4\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"C:\\\\Users\\\\TheTOP\\\\Documents\\\\GitHub\\\\pizza-chatbot-chk4\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\TheTOP\\\\Documents\\\\GitHub\\\\pizza-chatbot-chk4\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\TheTOP\\\\Documents\\\\GitHub\\\\pizza-chatbot-chk4\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\TheTOP\\\\Documents\\\\GitHub\\\\pizza-chatbot-chk4\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from'react';import Random from'random-id';import{CustomStep,OptionsStep,TextStep}from'./steps_components';import schema from'./schemas/schema';import*as storage from'./storage';import{ChatBotContainer,Content,Header,HeaderTitle,HeaderIcon,FloatButton,FloatingIcon,Footer,Input,SubmitButton}from'./components';import Recognition from'./recognition';import{ChatIcon,CloseIcon,SubmitIcon,MicIcon}from'./icons';import{isMobile}from'./utils';import{speakFn}from'./speechSynthesis';var ChatBot=/*#__PURE__*/function(_Component){_inherits(ChatBot,_Component);var _super=_createSuper(ChatBot);/* istanbul ignore next */function ChatBot(props){var _this;_classCallCheck(this,ChatBot);_this=_super.call(this,props);_this.onNodeInserted=function(event){var target=event.currentTarget;var enableSmoothScroll=_this.props.enableSmoothScroll;if(enableSmoothScroll&&_this.supportsScrollBehavior){target.scroll({top:target.scrollHeight,left:0,behavior:'smooth'});}else{target.scrollTop=target.scrollHeight;}};_this.onResize=function(){_this.content.scrollTop=_this.content.scrollHeight;};_this.onRecognitionChange=function(value){_this.setState({inputValue:value});};_this.onRecognitionEnd=function(){_this.setState({speaking:false});_this.handleSubmitButton();};_this.onRecognitionStop=function(){_this.setState({speaking:false});};_this.onValueChange=function(event){_this.setState({inputValue:event.target.value});};_this.getTriggeredStep=function(trigger,value){var steps=_this.generateRenderedStepsById();return typeof trigger==='function'?trigger({value:value,steps:steps}):trigger;};_this.getStepMessage=function(message){var previousSteps=_this.state.previousSteps;var lastStepIndex=previousSteps.length>0?previousSteps.length-1:0;var steps=_this.generateRenderedStepsById();var previousValue=previousSteps[lastStepIndex].value;return typeof message==='function'?message({previousValue:previousValue,steps:steps}):message;};_this.generateRenderedStepsById=function(){var previousSteps=_this.state.previousSteps;var steps={};for(var i=0,len=previousSteps.length;i<len;i+=1){var _previousSteps$i=previousSteps[i],id=_previousSteps$i.id,message=_previousSteps$i.message,value=_previousSteps$i.value,metadata=_previousSteps$i.metadata;steps[id]={id:id,message:message,value:value,metadata:metadata};}return steps;};_this.triggerNextStep=function(data){var enableMobileAutoFocus=_this.props.enableMobileAutoFocus;var _this$state=_this.state,defaultUserSettings=_this$state.defaultUserSettings,previousSteps=_this$state.previousSteps,renderedSteps=_this$state.renderedSteps,steps=_this$state.steps;var _this$state2=_this.state,currentStep=_this$state2.currentStep,previousStep=_this$state2.previousStep;var isEnd=currentStep.end;if(data&&data.value){currentStep.value=data.value;}if(data&&data.hideInput){currentStep.hideInput=data.hideInput;}if(data&&data.hideExtraControl){currentStep.hideExtraControl=data.hideExtraControl;}if(data&&data.trigger){currentStep.trigger=_this.getTriggeredStep(data.trigger,data.value);}if(isEnd){_this.handleEnd();}else if(currentStep.options&&data){var option=currentStep.options.filter(function(o){return o.value===data.value;})[0];var trigger=_this.getTriggeredStep(option.trigger,currentStep.value);delete currentStep.options;// replace choose option for user message\ncurrentStep=Object.assign({},currentStep,option,defaultUserSettings,{user:true,message:option.label,trigger:trigger});renderedSteps.pop();previousSteps.pop();renderedSteps.push(currentStep);previousSteps.push(currentStep);_this.setState({currentStep:currentStep,renderedSteps:renderedSteps,previousSteps:previousSteps});}else if(currentStep.trigger&&currentStep.replace&&data){var _trigger=_this.getTriggeredStep(currentStep.trigger,currentStep.value);var val=currentStep.value;var msg=data.msg;delete currentStep.component;currentStep=Object.assign({},currentStep,val,defaultUserSettings,{user:true,message:msg,trigger:_trigger});renderedSteps.pop();previousSteps.pop();renderedSteps.push(currentStep);previousSteps.push(currentStep);_this.setState({currentStep:currentStep,renderedSteps:renderedSteps,previousSteps:previousSteps});}else if(currentStep.trigger){var _trigger2=_this.getTriggeredStep(currentStep.trigger,currentStep.value);var nextStep=Object.assign({},steps[_trigger2]);if(nextStep.message){nextStep.message=_this.getStepMessage(nextStep.message);}else if(nextStep.update){var updateStep=nextStep;nextStep=Object.assign({},steps[updateStep.update]);if(nextStep.options){for(var i=0,len=nextStep.options.length;i<len;i+=1){nextStep.options[i].trigger=updateStep.trigger;}}else{nextStep.trigger=updateStep.trigger;}}nextStep.key=Random(24);previousStep=currentStep;currentStep=nextStep;_this.setState({renderedSteps:renderedSteps,currentStep:currentStep,previousStep:previousStep},function(){if(nextStep.user){_this.setState({disabled:false},function(){if(enableMobileAutoFocus||!isMobile()){if(_this.input){_this.input.focus();}}});}else{renderedSteps.push(nextStep);previousSteps.push(nextStep);_this.setState({renderedSteps:renderedSteps,previousSteps:previousSteps});}});}var _this$props=_this.props,cache=_this$props.cache,cacheName=_this$props.cacheName;if(cache){setTimeout(function(){storage.setData(cacheName,{currentStep:currentStep,previousStep:previousStep,previousSteps:previousSteps,renderedSteps:renderedSteps});},300);}};_this.handleEnd=function(){var handleEnd=_this.props.handleEnd;if(handleEnd){var previousSteps=_this.state.previousSteps;var renderedSteps=previousSteps.map(function(step){var id=step.id,message=step.message,value=step.value,metadata=step.metadata;return{id:id,message:message,value:value,metadata:metadata};});var steps=[];for(var i=0,len=previousSteps.length;i<len;i+=1){var _previousSteps$i2=previousSteps[i],id=_previousSteps$i2.id,message=_previousSteps$i2.message,value=_previousSteps$i2.value,metadata=_previousSteps$i2.metadata;steps[id]={id:id,message:message,value:value,metadata:metadata};}var values=previousSteps.filter(function(step){return step.value;}).map(function(step){return step.value;});handleEnd({renderedSteps:renderedSteps,steps:steps,values:values});}};_this.isInputValueEmpty=function(){var inputValue=_this.state.inputValue;return!inputValue||inputValue.length===0;};_this.isLastPosition=function(step){var renderedSteps=_this.state.renderedSteps;var length=renderedSteps.length;var stepIndex=renderedSteps.map(function(s){return s.key;}).indexOf(step.key);if(length<=1||stepIndex+1===length){return true;}var nextStep=renderedSteps[stepIndex+1];var hasMessage=nextStep.message||nextStep.asMessage;if(!hasMessage){return true;}var isLast=step.user!==nextStep.user;return isLast;};_this.isFirstPosition=function(step){var renderedSteps=_this.state.renderedSteps;var stepIndex=renderedSteps.map(function(s){return s.key;}).indexOf(step.key);if(stepIndex===0){return true;}var lastStep=renderedSteps[stepIndex-1];var hasMessage=lastStep.message||lastStep.asMessage;if(!hasMessage){return true;}var isFirst=step.user!==lastStep.user;return isFirst;};_this.handleKeyPress=function(event){if(event.key==='Enter'){_this.submitUserMessage();}};_this.handleSubmitButton=function(){var _this$state3=_this.state,speaking=_this$state3.speaking,recognitionEnable=_this$state3.recognitionEnable;if((_this.isInputValueEmpty()||speaking)&&recognitionEnable){_this.recognition.speak();if(!speaking){_this.setState({speaking:true});}return;}_this.submitUserMessage();};_this.submitUserMessage=function(){var _this$state4=_this.state,defaultUserSettings=_this$state4.defaultUserSettings,inputValue=_this$state4.inputValue,previousSteps=_this$state4.previousSteps,renderedSteps=_this$state4.renderedSteps;var currentStep=_this.state.currentStep;var isInvalid=currentStep.validator&&_this.checkInvalidInput();if(!isInvalid){var step={message:inputValue,value:inputValue};currentStep=Object.assign({},defaultUserSettings,currentStep,step);renderedSteps.push(currentStep);previousSteps.push(currentStep);_this.setState({currentStep:currentStep,renderedSteps:renderedSteps,previousSteps:previousSteps,disabled:true,inputValue:''},function(){if(_this.input){_this.input.blur();}});}};_this.checkInvalidInput=function(){var enableMobileAutoFocus=_this.props.enableMobileAutoFocus;var _this$state5=_this.state,currentStep=_this$state5.currentStep,inputValue=_this$state5.inputValue;var result=currentStep.validator(inputValue);var value=inputValue;if(typeof result!=='boolean'||!result){_this.setState({inputValue:result.toString(),inputInvalid:true,disabled:true},function(){setTimeout(function(){_this.setState({inputValue:value,inputInvalid:false,disabled:false},function(){if(enableMobileAutoFocus||!isMobile()){if(_this.input){_this.input.focus();}}});},2000);});return true;}return false;};_this.toggleChatBot=function(opened){var toggleFloating=_this.props.toggleFloating;if(toggleFloating){toggleFloating({opened:opened});}else{_this.setState({opened:opened});}};_this.renderStep=function(step,index){var renderedSteps=_this.state.renderedSteps;var _this$props2=_this.props,avatarStyle=_this$props2.avatarStyle,bubbleStyle=_this$props2.bubbleStyle,bubbleOptionStyle=_this$props2.bubbleOptionStyle,customStyle=_this$props2.customStyle,hideBotAvatar=_this$props2.hideBotAvatar,hideUserAvatar=_this$props2.hideUserAvatar,speechSynthesis=_this$props2.speechSynthesis;var options=step.options,component=step.component,asMessage=step.asMessage;var steps=_this.generateRenderedStepsById();var previousStep=index>0?renderedSteps[index-1]:{};if(component&&!asMessage){return/*#__PURE__*/React.createElement(CustomStep,{key:index,speak:_this.speak,step:step,steps:steps,style:customStyle,previousStep:previousStep,previousValue:previousStep.value,triggerNextStep:_this.triggerNextStep});}if(options){return/*#__PURE__*/React.createElement(OptionsStep,{key:index,step:step,previousValue:previousStep.value,triggerNextStep:_this.triggerNextStep,bubbleOptionStyle:bubbleOptionStyle});}return/*#__PURE__*/React.createElement(TextStep,{key:index,step:step,steps:steps,speak:_this.speak,previousStep:previousStep,previousValue:previousStep.value,triggerNextStep:_this.triggerNextStep,avatarStyle:avatarStyle,bubbleStyle:bubbleStyle,hideBotAvatar:hideBotAvatar,hideUserAvatar:hideUserAvatar,speechSynthesis:speechSynthesis,isFirst:_this.isFirstPosition(step),isLast:_this.isLastPosition(step)});};_this.content=null;_this.input=null;_this.supportsScrollBehavior=false;_this.setContentRef=function(element){_this.content=element;};_this.setInputRef=function(element){_this.input=element;};_this.state={renderedSteps:[],previousSteps:[],currentStep:{},previousStep:{},steps:{},disabled:true,opened:props.opened||!props.floating,inputValue:'',inputInvalid:false,speaking:false,recognitionEnable:props.recognitionEnable&&Recognition.isSupported(),defaultUserSettings:{}};_this.speak=speakFn(props.speechSynthesis);return _this;}_createClass(ChatBot,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var steps=this.props.steps;var _this$props3=this.props,botDelay=_this$props3.botDelay,botAvatar=_this$props3.botAvatar,botName=_this$props3.botName,cache=_this$props3.cache,cacheName=_this$props3.cacheName,customDelay=_this$props3.customDelay,enableMobileAutoFocus=_this$props3.enableMobileAutoFocus,userAvatar=_this$props3.userAvatar,userDelay=_this$props3.userDelay;var chatSteps={};var defaultBotSettings={delay:botDelay,avatar:botAvatar,botName:botName};var defaultUserSettings={delay:userDelay,avatar:userAvatar,hideInput:false,hideExtraControl:false};var defaultCustomSettings={delay:customDelay};for(var i=0,len=steps.length;i<len;i+=1){var step=steps[i];var settings={};if(step.user){settings=defaultUserSettings;}else if(step.message||step.asMessage){settings=defaultBotSettings;}else if(step.component){settings=defaultCustomSettings;}chatSteps[step.id]=Object.assign({},settings,schema.parse(step));}schema.checkInvalidIds(chatSteps);var firstStep=steps[0];if(firstStep.message){var message=firstStep.message;firstStep.message=typeof message==='function'?message():message;chatSteps[firstStep.id].message=firstStep.message;}var recognitionEnable=this.state.recognitionEnable;var recognitionLang=this.props.recognitionLang;if(recognitionEnable){this.recognition=new Recognition(this.onRecognitionChange,this.onRecognitionEnd,this.onRecognitionStop,recognitionLang);}this.supportsScrollBehavior='scrollBehavior'in document.documentElement.style;if(this.content){this.content.addEventListener('DOMNodeInserted',this.onNodeInserted);window.addEventListener('resize',this.onResize);}var _storage$getData=storage.getData({cacheName:cacheName,cache:cache,firstStep:firstStep,steps:chatSteps},function(){// focus input if last step cached is a user step\n_this2.setState({disabled:false},function(){if(enableMobileAutoFocus||!isMobile()){if(_this2.input){_this2.input.focus();}}});}),currentStep=_storage$getData.currentStep,previousStep=_storage$getData.previousStep,previousSteps=_storage$getData.previousSteps,renderedSteps=_storage$getData.renderedSteps;this.setState({currentStep:currentStep,defaultUserSettings:defaultUserSettings,previousStep:previousStep,previousSteps:previousSteps,renderedSteps:renderedSteps,steps:chatSteps});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){if(this.content){this.content.removeEventListener('DOMNodeInserted',this.onNodeInserted);window.removeEventListener('resize',this.onResize);}}},{key:\"render\",value:function render(){var _this3=this;var _this$state6=this.state,currentStep=_this$state6.currentStep,disabled=_this$state6.disabled,inputInvalid=_this$state6.inputInvalid,inputValue=_this$state6.inputValue,opened=_this$state6.opened,renderedSteps=_this$state6.renderedSteps,speaking=_this$state6.speaking,recognitionEnable=_this$state6.recognitionEnable;var _this$props4=this.props,className=_this$props4.className,contentStyle=_this$props4.contentStyle,extraControl=_this$props4.extraControl,controlStyle=_this$props4.controlStyle,floating=_this$props4.floating,floatingIcon=_this$props4.floatingIcon,floatingStyle=_this$props4.floatingStyle,footerStyle=_this$props4.footerStyle,headerComponent=_this$props4.headerComponent,headerTitle=_this$props4.headerTitle,hideHeader=_this$props4.hideHeader,hideSubmitButton=_this$props4.hideSubmitButton,inputStyle=_this$props4.inputStyle,placeholder=_this$props4.placeholder,inputAttributes=_this$props4.inputAttributes,recognitionPlaceholder=_this$props4.recognitionPlaceholder,style=_this$props4.style,submitButtonStyle=_this$props4.submitButtonStyle,width=_this$props4.width,height=_this$props4.height;var header=headerComponent||/*#__PURE__*/React.createElement(Header,{className:\"rsc-header\"},/*#__PURE__*/React.createElement(HeaderTitle,{className:\"rsc-header-title\"},headerTitle),floating&&/*#__PURE__*/React.createElement(HeaderIcon,{className:\"rsc-header-close-button\",onClick:function onClick(){return _this3.toggleChatBot(false);}},/*#__PURE__*/React.createElement(CloseIcon,null)));var customControl;if(extraControl!==undefined){customControl=React.cloneElement(extraControl,{disabled:disabled,speaking:speaking,invalid:inputInvalid});}var icon=(this.isInputValueEmpty()||speaking)&&recognitionEnable?/*#__PURE__*/React.createElement(MicIcon,null):/*#__PURE__*/React.createElement(SubmitIcon,null);var inputPlaceholder=speaking?recognitionPlaceholder:currentStep.placeholder||placeholder;var inputAttributesOverride=currentStep.inputAttributes||inputAttributes;return/*#__PURE__*/React.createElement(\"div\",{className:\"rsc \".concat(className)},floating&&/*#__PURE__*/React.createElement(FloatButton,{className:\"rsc-float-button\",style:floatingStyle,opened:opened,onClick:function onClick(){return _this3.toggleChatBot(true);}},typeof floatingIcon==='string'?/*#__PURE__*/React.createElement(FloatingIcon,{src:floatingIcon}):floatingIcon),/*#__PURE__*/React.createElement(ChatBotContainer,{className:\"rsc-container\",floating:floating,floatingStyle:floatingStyle,opened:opened,style:style,width:width,height:height},!hideHeader&&header,/*#__PURE__*/React.createElement(Content,{className:\"rsc-content\",ref:this.setContentRef,floating:floating,style:contentStyle,height:height,hideInput:currentStep.hideInput},renderedSteps.map(this.renderStep)),/*#__PURE__*/React.createElement(Footer,{className:\"rsc-footer\",style:footerStyle},!currentStep.hideInput&&/*#__PURE__*/React.createElement(Input,Object.assign({type:\"textarea\",style:inputStyle,ref:this.setInputRef,className:\"rsc-input\",placeholder:inputInvalid?'':inputPlaceholder,onKeyPress:this.handleKeyPress,onChange:this.onValueChange,value:inputValue,floating:floating,invalid:inputInvalid,disabled:disabled,hasButton:!hideSubmitButton},inputAttributesOverride)),/*#__PURE__*/React.createElement(\"div\",{style:controlStyle,className:\"rsc-controls\"},!currentStep.hideInput&&!currentStep.hideExtraControl&&customControl,!currentStep.hideInput&&!hideSubmitButton&&/*#__PURE__*/React.createElement(SubmitButton,{className:\"rsc-submit-button\",style:submitButtonStyle,onClick:this.handleSubmitButton,invalid:inputInvalid,disabled:disabled,speaking:speaking},icon)))));}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){var opened=props.opened,toggleFloating=props.toggleFloating;if(toggleFloating!==undefined&&opened!==undefined&&opened!==state.opened){return _objectSpread(_objectSpread({},state),{},{opened:opened});}return state;}}]);return ChatBot;}(Component);ChatBot.defaultProps={avatarStyle:{},botDelay:1000,botName:'The bot',bubbleOptionStyle:{},bubbleStyle:{},cache:false,cacheName:'rsc_cache',className:'',contentStyle:{},customStyle:{},controlStyle:{position:'absolute',right:'0',top:'0'},customDelay:1000,enableMobileAutoFocus:false,enableSmoothScroll:false,extraControl:undefined,floating:false,floatingIcon:/*#__PURE__*/React.createElement(ChatIcon,null),floatingStyle:{},footerStyle:{},handleEnd:undefined,headerComponent:undefined,headerTitle:'Chat',height:'520px',hideBotAvatar:false,hideHeader:false,hideSubmitButton:false,hideUserAvatar:false,inputStyle:{},opened:undefined,placeholder:'Type the message ...',inputAttributes:{},recognitionEnable:false,recognitionLang:'en',recognitionPlaceholder:'Listening ...',speechSynthesis:{enable:false,lang:'en',voice:null},style:{},submitButtonStyle:{},toggleFloating:undefined,userDelay:1000,width:'350px',botAvatar:\"data:image/svg+xml,%3csvg version='1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3e%3cpath d='M303 70a47 47 0 1 0-70 40v84h46v-84c14-8 24-23 24-40z' fill='%2393c7ef'/%3e%3cpath d='M256 23v171h23v-84a47 47 0 0 0-23-87z' fill='%235a8bb0'/%3e%3cpath fill='%2393c7ef' d='M0 240h248v124H0z'/%3e%3cpath fill='%235a8bb0' d='M264 240h248v124H264z'/%3e%3cpath fill='%2393c7ef' d='M186 365h140v124H186z'/%3e%3cpath fill='%235a8bb0' d='M256 365h70v124h-70z'/%3e%3cpath fill='%23cce9f9' d='M47 163h419v279H47z'/%3e%3cpath fill='%2393c7ef' d='M256 163h209v279H256z'/%3e%3cpath d='M194 272a31 31 0 0 1-62 0c0-18 14-32 31-32s31 14 31 32z' fill='%233c5d76'/%3e%3cpath d='M380 272a31 31 0 0 1-62 0c0-18 14-32 31-32s31 14 31 32z' fill='%231e2e3b'/%3e%3cpath d='M186 349a70 70 0 1 0 140 0H186z' fill='%233c5d76'/%3e%3cpath d='M256 349v70c39 0 70-31 70-70h-70z' fill='%231e2e3b'/%3e%3c/svg%3e\",userAvatar:\"data:image/svg+xml,%3csvg viewBox='-208.5 21 100 100' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3ccircle cx='-158.5' cy='71' fill='%23F5EEE5' r='50'/%3e%3cdefs%3e%3ccircle cx='-158.5' cy='71' id='a' r='50'/%3e%3c/defs%3e%3cclipPath id='b'%3e%3cuse overflow='visible' xlink:href='%23a'/%3e%3c/clipPath%3e%3cpath clip-path='url(%23b)' d='M-108.5 121v-14s-21.2-4.9-28-6.7c-2.5-.7-7-3.3-7-12V82h-30v6.3c0 8.7-4.5 11.3-7 12-6.8 1.9-28.1 7.3-28.1 6.7v14h100.1z' fill='%23E6C19C'/%3e%3cg clip-path='url(%23b)'%3e%3cdefs%3e%3cpath d='M-108.5 121v-14s-21.2-4.9-28-6.7c-2.5-.7-7-3.3-7-12V82h-30v6.3c0 8.7-4.5 11.3-7 12-6.8 1.9-28.1 7.3-28.1 6.7v14h100.1z' id='c'/%3e%3c/defs%3e%3cclipPath id='d'%3e%3cuse overflow='visible' xlink:href='%23c'/%3e%3c/clipPath%3e%3cpath clip-path='url(%23d)' d='M-158.5 100.1c12.7 0 23-18.6 23-34.4 0-16.2-10.3-24.7-23-24.7s-23 8.5-23 24.7c0 15.8 10.3 34.4 23 34.4z' fill='%23D4B08C'/%3e%3c/g%3e%3cpath d='M-158.5 96c12.7 0 23-16.3 23-31 0-15.1-10.3-23-23-23s-23 7.9-23 23c0 14.7 10.3 31 23 31z' fill='%23F2CEA5'/%3e%3c/svg%3e\"};export default ChatBot;","map":{"version":3,"sources":["C:/Users/TheTOP/Documents/GitHub/pizza-chatbot-chk4/src/components/chatbot/ChatBot.jsx"],"names":["React","Component","Random","CustomStep","OptionsStep","TextStep","schema","storage","ChatBotContainer","Content","Header","HeaderTitle","HeaderIcon","FloatButton","FloatingIcon","Footer","Input","SubmitButton","Recognition","ChatIcon","CloseIcon","SubmitIcon","MicIcon","isMobile","speakFn","ChatBot","props","onNodeInserted","event","target","currentTarget","enableSmoothScroll","supportsScrollBehavior","scroll","top","scrollHeight","left","behavior","scrollTop","onResize","content","onRecognitionChange","value","setState","inputValue","onRecognitionEnd","speaking","handleSubmitButton","onRecognitionStop","onValueChange","getTriggeredStep","trigger","steps","generateRenderedStepsById","getStepMessage","message","previousSteps","state","lastStepIndex","length","previousValue","i","len","id","metadata","triggerNextStep","data","enableMobileAutoFocus","defaultUserSettings","renderedSteps","currentStep","previousStep","isEnd","end","hideInput","hideExtraControl","handleEnd","options","option","filter","o","Object","assign","user","label","pop","push","replace","val","msg","component","nextStep","update","updateStep","key","disabled","input","focus","cache","cacheName","setTimeout","setData","map","step","values","isInputValueEmpty","isLastPosition","stepIndex","s","indexOf","hasMessage","asMessage","isLast","isFirstPosition","lastStep","isFirst","handleKeyPress","submitUserMessage","recognitionEnable","recognition","speak","isInvalid","validator","checkInvalidInput","blur","result","toString","inputInvalid","toggleChatBot","opened","toggleFloating","renderStep","index","avatarStyle","bubbleStyle","bubbleOptionStyle","customStyle","hideBotAvatar","hideUserAvatar","speechSynthesis","setContentRef","element","setInputRef","floating","isSupported","botDelay","botAvatar","botName","customDelay","userAvatar","userDelay","chatSteps","defaultBotSettings","delay","avatar","defaultCustomSettings","settings","parse","checkInvalidIds","firstStep","recognitionLang","document","documentElement","style","addEventListener","window","getData","removeEventListener","className","contentStyle","extraControl","controlStyle","floatingIcon","floatingStyle","footerStyle","headerComponent","headerTitle","hideHeader","hideSubmitButton","inputStyle","placeholder","inputAttributes","recognitionPlaceholder","submitButtonStyle","width","height","header","customControl","undefined","cloneElement","invalid","icon","inputPlaceholder","inputAttributesOverride","defaultProps","position","right","enable","lang","voice"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Random from 'random-id';\r\nimport { CustomStep, OptionsStep, TextStep } from './steps_components';\r\nimport schema from './schemas/schema';\r\nimport * as storage from './storage';\r\nimport {\r\n  ChatBotContainer,\r\n  Content,\r\n  Header,\r\n  HeaderTitle,\r\n  HeaderIcon,\r\n  FloatButton,\r\n  FloatingIcon,\r\n  Footer,\r\n  Input,\r\n  SubmitButton\r\n} from './components';\r\nimport Recognition from './recognition';\r\nimport { ChatIcon, CloseIcon, SubmitIcon, MicIcon } from './icons';\r\nimport { isMobile } from './utils';\r\nimport { speakFn } from './speechSynthesis';\r\n\r\nclass ChatBot extends Component {\r\n  /* istanbul ignore next */\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.content = null;\r\n    this.input = null;\r\n\r\n    this.supportsScrollBehavior = false;\r\n\r\n    this.setContentRef = element => {\r\n      this.content = element;\r\n    };\r\n\r\n    this.setInputRef = element => {\r\n      this.input = element;\r\n    };\r\n\r\n    this.state = {\r\n      renderedSteps: [],\r\n      previousSteps: [],\r\n      currentStep: {},\r\n      previousStep: {},\r\n      steps: {},\r\n      disabled: true,\r\n      opened: props.opened || !props.floating,\r\n      inputValue: '',\r\n      inputInvalid: false,\r\n      speaking: false,\r\n      recognitionEnable: props.recognitionEnable && Recognition.isSupported(),\r\n      defaultUserSettings: {}\r\n    };\r\n\r\n    this.speak = speakFn(props.speechSynthesis);\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { steps } = this.props;\r\n    const {\r\n      botDelay,\r\n      botAvatar,\r\n      botName,\r\n      cache,\r\n      cacheName,\r\n      customDelay,\r\n      enableMobileAutoFocus,\r\n      userAvatar,\r\n      userDelay\r\n    } = this.props;\r\n    const chatSteps = {};\r\n\r\n    const defaultBotSettings = { delay: botDelay, avatar: botAvatar, botName };\r\n    const defaultUserSettings = {\r\n      delay: userDelay,\r\n      avatar: userAvatar,\r\n      hideInput: false,\r\n      hideExtraControl: false\r\n    };\r\n    const defaultCustomSettings = { delay: customDelay };\r\n\r\n    for (let i = 0, len = steps.length; i < len; i += 1) {\r\n      const step = steps[i];\r\n      let settings = {};\r\n\r\n      if (step.user) {\r\n        settings = defaultUserSettings;\r\n      } else if (step.message || step.asMessage) {\r\n        settings = defaultBotSettings;\r\n      } else if (step.component) {\r\n        settings = defaultCustomSettings;\r\n      }\r\n\r\n      chatSteps[step.id] = Object.assign({}, settings, schema.parse(step));\r\n    }\r\n\r\n    schema.checkInvalidIds(chatSteps);\r\n\r\n    const firstStep = steps[0];\r\n\r\n    if (firstStep.message) {\r\n      const { message } = firstStep;\r\n      firstStep.message = typeof message === 'function' ? message() : message;\r\n      chatSteps[firstStep.id].message = firstStep.message;\r\n    }\r\n\r\n    const { recognitionEnable } = this.state;\r\n    const { recognitionLang } = this.props;\r\n\r\n    if (recognitionEnable) {\r\n      this.recognition = new Recognition(\r\n        this.onRecognitionChange,\r\n        this.onRecognitionEnd,\r\n        this.onRecognitionStop,\r\n        recognitionLang\r\n      );\r\n    }\r\n\r\n    this.supportsScrollBehavior = 'scrollBehavior' in document.documentElement.style;\r\n\r\n    if (this.content) {\r\n      this.content.addEventListener('DOMNodeInserted', this.onNodeInserted);\r\n      window.addEventListener('resize', this.onResize);\r\n    }\r\n\r\n    const { currentStep, previousStep, previousSteps, renderedSteps } = storage.getData(\r\n      {\r\n        cacheName,\r\n        cache,\r\n        firstStep,\r\n        steps: chatSteps\r\n      },\r\n      () => {\r\n        // focus input if last step cached is a user step\r\n        this.setState({ disabled: false }, () => {\r\n          if (enableMobileAutoFocus || !isMobile()) {\r\n            if (this.input) {\r\n              this.input.focus();\r\n            }\r\n          }\r\n        });\r\n      }\r\n    );\r\n\r\n    this.setState({\r\n      currentStep,\r\n      defaultUserSettings,\r\n      previousStep,\r\n      previousSteps,\r\n      renderedSteps,\r\n      steps: chatSteps\r\n    });\r\n  }\r\n\r\n  static getDerivedStateFromProps(props, state) {\r\n    const { opened, toggleFloating } = props;\r\n    if (toggleFloating !== undefined && opened !== undefined && opened !== state.opened) {\r\n      return {\r\n        ...state,\r\n        opened\r\n      };\r\n    }\r\n    return state;\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.content) {\r\n      this.content.removeEventListener('DOMNodeInserted', this.onNodeInserted);\r\n      window.removeEventListener('resize', this.onResize);\r\n    }\r\n  }\r\n\r\n  onNodeInserted = event => {\r\n    const { currentTarget: target } = event;\r\n    const { enableSmoothScroll } = this.props;\r\n\r\n    if (enableSmoothScroll && this.supportsScrollBehavior) {\r\n      target.scroll({\r\n        top: target.scrollHeight,\r\n        left: 0,\r\n        behavior: 'smooth'\r\n      });\r\n    } else {\r\n      target.scrollTop = target.scrollHeight;\r\n    }\r\n  };\r\n\r\n  onResize = () => {\r\n    this.content.scrollTop = this.content.scrollHeight;\r\n  };\r\n\r\n  onRecognitionChange = value => {\r\n    this.setState({ inputValue: value });\r\n  };\r\n\r\n  onRecognitionEnd = () => {\r\n    this.setState({ speaking: false });\r\n    this.handleSubmitButton();\r\n  };\r\n\r\n  onRecognitionStop = () => {\r\n    this.setState({ speaking: false });\r\n  };\r\n\r\n  onValueChange = event => {\r\n    this.setState({ inputValue: event.target.value });\r\n  };\r\n\r\n  getTriggeredStep = (trigger, value) => {\r\n    const steps = this.generateRenderedStepsById();\r\n    return typeof trigger === 'function' ? trigger({ value, steps }) : trigger;\r\n  };\r\n\r\n  getStepMessage = message => {\r\n    const { previousSteps } = this.state;\r\n    const lastStepIndex = previousSteps.length > 0 ? previousSteps.length - 1 : 0;\r\n    const steps = this.generateRenderedStepsById();\r\n    const previousValue = previousSteps[lastStepIndex].value;\r\n    return typeof message === 'function' ? message({ previousValue, steps }) : message;\r\n  };\r\n\r\n  generateRenderedStepsById = () => {\r\n    const { previousSteps } = this.state;\r\n    const steps = {};\r\n\r\n    for (let i = 0, len = previousSteps.length; i < len; i += 1) {\r\n      const { id, message, value, metadata } = previousSteps[i];\r\n\r\n      steps[id] = {\r\n        id,\r\n        message,\r\n        value,\r\n        metadata\r\n      };\r\n    }\r\n\r\n    return steps;\r\n  };\r\n\r\n  triggerNextStep = data => {\r\n    const { enableMobileAutoFocus } = this.props;\r\n    const { defaultUserSettings, previousSteps, renderedSteps, steps } = this.state;\r\n\r\n    let { currentStep, previousStep } = this.state;\r\n    const isEnd = currentStep.end;\r\n\r\n    if (data && data.value) {\r\n      currentStep.value = data.value;\r\n    }\r\n    if (data && data.hideInput) {\r\n      currentStep.hideInput = data.hideInput;\r\n    }\r\n    if (data && data.hideExtraControl) {\r\n      currentStep.hideExtraControl = data.hideExtraControl;\r\n    }\r\n    if (data && data.trigger) {\r\n      currentStep.trigger = this.getTriggeredStep(data.trigger, data.value);\r\n    }\r\n\r\n    if (isEnd) {\r\n      this.handleEnd();\r\n    } else if (currentStep.options && data) {\r\n      const option = currentStep.options.filter(o => o.value === data.value)[0];\r\n      const trigger = this.getTriggeredStep(option.trigger, currentStep.value);\r\n      delete currentStep.options;\r\n      \r\n      // replace choose option for user message\r\n      currentStep = Object.assign({}, currentStep, option, defaultUserSettings, {\r\n        user: true,\r\n        message: option.label,\r\n        trigger\r\n      });     \r\n      renderedSteps.pop();\r\n      previousSteps.pop();\r\n      renderedSteps.push(currentStep);\r\n      previousSteps.push(currentStep);\r\n\r\n      this.setState({\r\n        currentStep,\r\n        renderedSteps,\r\n        previousSteps\r\n      });\r\n    } else if (currentStep.trigger && currentStep.replace && data) {\r\n        const trigger = this.getTriggeredStep(currentStep.trigger, currentStep.value);      \r\n        const val = currentStep.value;\r\n        const msg = data.msg;\r\n        delete currentStep.component;  \r\n             \r\n        currentStep = Object.assign({}, currentStep, val, defaultUserSettings, {\r\n          user: true,\r\n          message: msg,\r\n          trigger\r\n        }); \r\n        \r\n        renderedSteps.pop();\r\n        previousSteps.pop();\r\n        renderedSteps.push(currentStep);\r\n        previousSteps.push(currentStep);\r\n        \r\n        this.setState({\r\n          currentStep,\r\n          renderedSteps,\r\n          previousSteps\r\n        });\r\n      } else if (currentStep.trigger) {      \r\n      \r\n       const trigger = this.getTriggeredStep(currentStep.trigger, currentStep.value);  \r\n        let nextStep = Object.assign({}, steps[trigger]);\r\n     \r\n      if (nextStep.message) {\r\n        nextStep.message = this.getStepMessage(nextStep.message);\r\n      } else if (nextStep.update) {\r\n        const updateStep = nextStep;\r\n        nextStep = Object.assign({}, steps[updateStep.update]);\r\n\r\n        if (nextStep.options) {\r\n          for (let i = 0, len = nextStep.options.length; i < len; i += 1) {\r\n            nextStep.options[i].trigger = updateStep.trigger;\r\n          }\r\n        } else {\r\n          nextStep.trigger = updateStep.trigger;\r\n        }\r\n      }\r\n\r\n      nextStep.key = Random(24);\r\n\r\n      previousStep = currentStep;\r\n      currentStep = nextStep;\r\n\r\n      this.setState({ renderedSteps, currentStep, previousStep }, () => {\r\n        if (nextStep.user) {\r\n          this.setState({ disabled: false }, () => {\r\n            if (enableMobileAutoFocus || !isMobile()) {\r\n              if (this.input) {\r\n                this.input.focus();\r\n              }\r\n            }\r\n          });\r\n        } else {\r\n          renderedSteps.push(nextStep);\r\n          previousSteps.push(nextStep);\r\n\r\n          this.setState({ renderedSteps, previousSteps });\r\n        }\r\n      });\r\n    }\r\n\r\n    const { cache, cacheName } = this.props;\r\n    if (cache) {\r\n      setTimeout(() => {\r\n        storage.setData(cacheName, {\r\n          currentStep,\r\n          previousStep,\r\n          previousSteps,\r\n          renderedSteps\r\n        });\r\n      }, 300);\r\n    }\r\n  };\r\n\r\n  handleEnd = () => {\r\n    const { handleEnd } = this.props;\r\n\r\n    if (handleEnd) {\r\n      const { previousSteps } = this.state;\r\n\r\n      const renderedSteps = previousSteps.map(step => {\r\n        const { id, message, value, metadata } = step;\r\n\r\n        return {\r\n          id,\r\n          message,\r\n          value,\r\n          metadata\r\n        };\r\n      });\r\n\r\n      const steps = [];\r\n\r\n      for (let i = 0, len = previousSteps.length; i < len; i += 1) {\r\n        const { id, message, value, metadata } = previousSteps[i];\r\n\r\n        steps[id] = {\r\n          id,\r\n          message,\r\n          value,\r\n          metadata\r\n        };\r\n      }\r\n\r\n      const values = previousSteps.filter(step => step.value).map(step => step.value);\r\n\r\n      handleEnd({ renderedSteps, steps, values });\r\n    }\r\n  };\r\n\r\n  isInputValueEmpty = () => {\r\n    const { inputValue } = this.state;\r\n    return !inputValue || inputValue.length === 0;\r\n  };\r\n\r\n  isLastPosition = step => {\r\n    const { renderedSteps } = this.state;\r\n    const { length } = renderedSteps;\r\n    const stepIndex = renderedSteps.map(s => s.key).indexOf(step.key);\r\n\r\n    if (length <= 1 || stepIndex + 1 === length) {\r\n      return true;\r\n    }\r\n\r\n    const nextStep = renderedSteps[stepIndex + 1];\r\n    const hasMessage = nextStep.message || nextStep.asMessage;\r\n\r\n    if (!hasMessage) {\r\n      return true;\r\n    }\r\n\r\n    const isLast = step.user !== nextStep.user;\r\n    return isLast;\r\n  };\r\n\r\n  isFirstPosition = step => {\r\n    const { renderedSteps } = this.state;\r\n    const stepIndex = renderedSteps.map(s => s.key).indexOf(step.key);\r\n\r\n    if (stepIndex === 0) {\r\n      return true;\r\n    }\r\n\r\n    const lastStep = renderedSteps[stepIndex - 1];\r\n    const hasMessage = lastStep.message || lastStep.asMessage;\r\n\r\n    if (!hasMessage) {\r\n      return true;\r\n    }\r\n\r\n    const isFirst = step.user !== lastStep.user;\r\n    return isFirst;\r\n  };\r\n\r\n  handleKeyPress = event => {\r\n    if (event.key === 'Enter') {\r\n      this.submitUserMessage();\r\n    }\r\n  };\r\n\r\n  handleSubmitButton = () => {\r\n    const { speaking, recognitionEnable } = this.state;\r\n\r\n    if ((this.isInputValueEmpty() || speaking) && recognitionEnable) {\r\n      this.recognition.speak();\r\n      if (!speaking) {\r\n        this.setState({ speaking: true });\r\n      }\r\n      return;\r\n    }\r\n\r\n    this.submitUserMessage();\r\n  };\r\n\r\n  submitUserMessage = () => {\r\n    const { defaultUserSettings, inputValue, previousSteps, renderedSteps } = this.state;\r\n    let { currentStep } = this.state;\r\n\r\n    const isInvalid = currentStep.validator && this.checkInvalidInput();\r\n\r\n    if (!isInvalid) {\r\n      const step = {\r\n        message: inputValue,\r\n        value: inputValue\r\n      };\r\n\r\n      currentStep = Object.assign({}, defaultUserSettings, currentStep, step);\r\n\r\n      renderedSteps.push(currentStep);\r\n      previousSteps.push(currentStep);\r\n\r\n      this.setState(\r\n        {\r\n          currentStep,\r\n          renderedSteps,\r\n          previousSteps,\r\n          disabled: true,\r\n          inputValue: ''\r\n        },\r\n        () => {\r\n          if (this.input) {\r\n            this.input.blur();\r\n          }\r\n        }\r\n      );\r\n    }\r\n  };\r\n\r\n  checkInvalidInput = () => {\r\n    const { enableMobileAutoFocus } = this.props;\r\n    const { currentStep, inputValue } = this.state;\r\n    const result = currentStep.validator(inputValue);\r\n    const value = inputValue;\r\n\r\n    if (typeof result !== 'boolean' || !result) {\r\n      this.setState(\r\n        {\r\n          inputValue: result.toString(),\r\n          inputInvalid: true,\r\n          disabled: true\r\n        },\r\n        () => {\r\n          setTimeout(() => {\r\n            this.setState(\r\n              {\r\n                inputValue: value,\r\n                inputInvalid: false,\r\n                disabled: false\r\n              },\r\n              () => {\r\n                if (enableMobileAutoFocus || !isMobile()) {\r\n                  if (this.input) {\r\n                    this.input.focus();\r\n                  }\r\n                }\r\n              }\r\n            );\r\n          }, 2000);\r\n        }\r\n      );\r\n\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  };\r\n\r\n  toggleChatBot = opened => {\r\n    const { toggleFloating } = this.props;\r\n\r\n    if (toggleFloating) {\r\n      toggleFloating({ opened });\r\n    } else {\r\n      this.setState({ opened });\r\n    }\r\n  };\r\n\r\n  renderStep = (step, index) => {\r\n    const { renderedSteps } = this.state;\r\n    const {\r\n      avatarStyle,\r\n      bubbleStyle,\r\n      bubbleOptionStyle,\r\n      customStyle,\r\n      hideBotAvatar,\r\n      hideUserAvatar,\r\n      speechSynthesis\r\n    } = this.props;\r\n    const { options, component, asMessage } = step;\r\n    const steps = this.generateRenderedStepsById();\r\n    const previousStep = index > 0 ? renderedSteps[index - 1] : {};\r\n\r\n    if (component && !asMessage) {\r\n      return (\r\n        <CustomStep\r\n          key={index}\r\n          speak={this.speak}\r\n          step={step}\r\n          steps={steps}\r\n          style={customStyle}\r\n          previousStep={previousStep}\r\n          previousValue={previousStep.value}\r\n          triggerNextStep={this.triggerNextStep}\r\n        />\r\n      );\r\n    }\r\n\r\n    if (options) {\r\n      return (\r\n        <OptionsStep\r\n          key={index}\r\n          step={step}\r\n          previousValue={previousStep.value}\r\n          triggerNextStep={this.triggerNextStep}\r\n          bubbleOptionStyle={bubbleOptionStyle}\r\n        />\r\n      );\r\n    }\r\n\r\n    return (\r\n      <TextStep\r\n        key={index}\r\n        step={step}\r\n        steps={steps}\r\n        speak={this.speak}\r\n        previousStep={previousStep}\r\n        previousValue={previousStep.value}\r\n        triggerNextStep={this.triggerNextStep}\r\n        avatarStyle={avatarStyle}\r\n        bubbleStyle={bubbleStyle}\r\n        hideBotAvatar={hideBotAvatar}\r\n        hideUserAvatar={hideUserAvatar}\r\n        speechSynthesis={speechSynthesis}\r\n        isFirst={this.isFirstPosition(step)}\r\n        isLast={this.isLastPosition(step)}\r\n      />\r\n    );\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      currentStep,\r\n      disabled,\r\n      inputInvalid,\r\n      inputValue,\r\n      opened,\r\n      renderedSteps,\r\n      speaking,\r\n      recognitionEnable\r\n    } = this.state;\r\n    const {\r\n      className,\r\n      contentStyle,\r\n      extraControl,\r\n      controlStyle,\r\n      floating,\r\n      floatingIcon,\r\n      floatingStyle,\r\n      footerStyle,\r\n      headerComponent,\r\n      headerTitle,\r\n      hideHeader,\r\n      hideSubmitButton,\r\n      inputStyle,\r\n      placeholder,\r\n      inputAttributes,\r\n      recognitionPlaceholder,\r\n      style,\r\n      submitButtonStyle,\r\n      width,\r\n      height\r\n    } = this.props;\r\n\r\n    const header = headerComponent || (\r\n      <Header className=\"rsc-header\">\r\n        <HeaderTitle className=\"rsc-header-title\">{headerTitle}</HeaderTitle>\r\n        {floating && (\r\n          <HeaderIcon className=\"rsc-header-close-button\" onClick={() => this.toggleChatBot(false)}>\r\n            <CloseIcon />\r\n          </HeaderIcon>\r\n        )}\r\n      </Header>\r\n    );\r\n\r\n    let customControl;\r\n    if (extraControl !== undefined) {\r\n      customControl = React.cloneElement(extraControl, {\r\n        disabled,\r\n        speaking,\r\n        invalid: inputInvalid\r\n      });\r\n    }\r\n\r\n    const icon =\r\n      (this.isInputValueEmpty() || speaking) && recognitionEnable ? <MicIcon /> : <SubmitIcon />;\r\n\r\n    const inputPlaceholder = speaking\r\n      ? recognitionPlaceholder\r\n      : currentStep.placeholder || placeholder;\r\n\r\n    const inputAttributesOverride = currentStep.inputAttributes || inputAttributes;\r\n\r\n    return (\r\n      <div className={`rsc ${className}`}>\r\n        {floating && (\r\n          <FloatButton\r\n            className=\"rsc-float-button\"\r\n            style={floatingStyle}\r\n            opened={opened}\r\n            onClick={() => this.toggleChatBot(true)}\r\n          >\r\n            {typeof floatingIcon === 'string' ? <FloatingIcon src={floatingIcon} /> : floatingIcon}\r\n          </FloatButton>\r\n        )}\r\n        <ChatBotContainer\r\n          className=\"rsc-container\"\r\n          floating={floating}\r\n          floatingStyle={floatingStyle}\r\n          opened={opened}\r\n          style={style}\r\n          width={width}\r\n          height={height}\r\n        >\r\n          {!hideHeader && header}\r\n          <Content\r\n            className=\"rsc-content\"\r\n            ref={this.setContentRef}\r\n            floating={floating}\r\n            style={contentStyle}\r\n            height={height}\r\n            hideInput={currentStep.hideInput}\r\n          >\r\n            {renderedSteps.map(this.renderStep)}\r\n          </Content>\r\n          <Footer className=\"rsc-footer\" style={footerStyle}>\r\n            {!currentStep.hideInput && (\r\n              <Input\r\n                type=\"textarea\"\r\n                style={inputStyle}\r\n                ref={this.setInputRef}\r\n                className=\"rsc-input\"\r\n                placeholder={inputInvalid ? '' : inputPlaceholder}\r\n                onKeyPress={this.handleKeyPress}\r\n                onChange={this.onValueChange}\r\n                value={inputValue}\r\n                floating={floating}\r\n                invalid={inputInvalid}\r\n                disabled={disabled}\r\n                hasButton={!hideSubmitButton}\r\n                {...inputAttributesOverride}\r\n              />\r\n            )}\r\n            <div style={controlStyle} className=\"rsc-controls\">\r\n              {!currentStep.hideInput && !currentStep.hideExtraControl && customControl}\r\n              {!currentStep.hideInput && !hideSubmitButton && (\r\n                <SubmitButton\r\n                  className=\"rsc-submit-button\"\r\n                  style={submitButtonStyle}\r\n                  onClick={this.handleSubmitButton}\r\n                  invalid={inputInvalid}\r\n                  disabled={disabled}\r\n                  speaking={speaking}\r\n                >\r\n                  {icon}\r\n                </SubmitButton>\r\n              )}\r\n            </div>\r\n          </Footer>\r\n        </ChatBotContainer>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nChatBot.propTypes = {\r\n  avatarStyle: PropTypes.objectOf(PropTypes.any),\r\n  botAvatar: PropTypes.string,\r\n  botName: PropTypes.string,\r\n  botDelay: PropTypes.number,\r\n  bubbleOptionStyle: PropTypes.objectOf(PropTypes.any),\r\n  bubbleStyle: PropTypes.objectOf(PropTypes.any),\r\n  cache: PropTypes.bool,\r\n  cacheName: PropTypes.string,\r\n  className: PropTypes.string,\r\n  contentStyle: PropTypes.objectOf(PropTypes.any),\r\n  customDelay: PropTypes.number,\r\n  customStyle: PropTypes.objectOf(PropTypes.any),\r\n  controlStyle: PropTypes.objectOf(PropTypes.any),\r\n  enableMobileAutoFocus: PropTypes.bool,\r\n  enableSmoothScroll: PropTypes.bool,\r\n  extraControl: PropTypes.objectOf(PropTypes.element),\r\n  floating: PropTypes.bool,\r\n  floatingIcon: PropTypes.oneOfType([PropTypes.string, PropTypes.element]),\r\n  floatingStyle: PropTypes.objectOf(PropTypes.any),\r\n  footerStyle: PropTypes.objectOf(PropTypes.any),\r\n  handleEnd: PropTypes.func,\r\n  headerComponent: PropTypes.element,\r\n  headerTitle: PropTypes.string,\r\n  height: PropTypes.string,\r\n  hideBotAvatar: PropTypes.bool,\r\n  hideHeader: PropTypes.bool,\r\n  hideSubmitButton: PropTypes.bool,\r\n  hideUserAvatar: PropTypes.bool,\r\n  inputAttributes: PropTypes.objectOf(PropTypes.any),\r\n  inputStyle: PropTypes.objectOf(PropTypes.any),\r\n  opened: PropTypes.bool,\r\n  toggleFloating: PropTypes.func,\r\n  placeholder: PropTypes.string,\r\n  recognitionEnable: PropTypes.bool,\r\n  recognitionLang: PropTypes.string,\r\n  recognitionPlaceholder: PropTypes.string,\r\n  speechSynthesis: PropTypes.shape({\r\n    enable: PropTypes.bool,\r\n    lang: PropTypes.string,\r\n    voice:\r\n      typeof window !== 'undefined'\r\n        ? PropTypes.instanceOf(window.SpeechSynthesisVoice)\r\n        : PropTypes.any\r\n  }),\r\n  steps: PropTypes.arrayOf(PropTypes.object).isRequired,\r\n  style: PropTypes.objectOf(PropTypes.any),\r\n  submitButtonStyle: PropTypes.objectOf(PropTypes.any),\r\n  userAvatar: PropTypes.string,\r\n  userDelay: PropTypes.number,\r\n  width: PropTypes.string\r\n};\r\n\r\nChatBot.defaultProps = {\r\n  avatarStyle: {},\r\n  botDelay: 1000,\r\n  botName: 'The bot',\r\n  bubbleOptionStyle: {},\r\n  bubbleStyle: {},\r\n  cache: false,\r\n  cacheName: 'rsc_cache',\r\n  className: '',\r\n  contentStyle: {},\r\n  customStyle: {},\r\n  controlStyle: { position: 'absolute', right: '0', top: '0' },\r\n  customDelay: 1000,\r\n  enableMobileAutoFocus: false,\r\n  enableSmoothScroll: false,\r\n  extraControl: undefined,\r\n  floating: false,\r\n  floatingIcon: <ChatIcon />,\r\n  floatingStyle: {},\r\n  footerStyle: {},\r\n  handleEnd: undefined,\r\n  headerComponent: undefined,\r\n  headerTitle: 'Chat',\r\n  height: '520px',\r\n  hideBotAvatar: false,\r\n  hideHeader: false,\r\n  hideSubmitButton: false,\r\n  hideUserAvatar: false,\r\n  inputStyle: {},\r\n  opened: undefined,\r\n  placeholder: 'Type the message ...',\r\n  inputAttributes: {},\r\n  recognitionEnable: false,\r\n  recognitionLang: 'en',\r\n  recognitionPlaceholder: 'Listening ...',\r\n  speechSynthesis: {\r\n    enable: false,\r\n    lang: 'en',\r\n    voice: null\r\n  },\r\n  style: {},\r\n  submitButtonStyle: {},\r\n  toggleFloating: undefined,\r\n  userDelay: 1000,\r\n  width: '350px',\r\n  botAvatar:\r\n    \"data:image/svg+xml,%3csvg version='1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3e%3cpath d='M303 70a47 47 0 1 0-70 40v84h46v-84c14-8 24-23 24-40z' fill='%2393c7ef'/%3e%3cpath d='M256 23v171h23v-84a47 47 0 0 0-23-87z' fill='%235a8bb0'/%3e%3cpath fill='%2393c7ef' d='M0 240h248v124H0z'/%3e%3cpath fill='%235a8bb0' d='M264 240h248v124H264z'/%3e%3cpath fill='%2393c7ef' d='M186 365h140v124H186z'/%3e%3cpath fill='%235a8bb0' d='M256 365h70v124h-70z'/%3e%3cpath fill='%23cce9f9' d='M47 163h419v279H47z'/%3e%3cpath fill='%2393c7ef' d='M256 163h209v279H256z'/%3e%3cpath d='M194 272a31 31 0 0 1-62 0c0-18 14-32 31-32s31 14 31 32z' fill='%233c5d76'/%3e%3cpath d='M380 272a31 31 0 0 1-62 0c0-18 14-32 31-32s31 14 31 32z' fill='%231e2e3b'/%3e%3cpath d='M186 349a70 70 0 1 0 140 0H186z' fill='%233c5d76'/%3e%3cpath d='M256 349v70c39 0 70-31 70-70h-70z' fill='%231e2e3b'/%3e%3c/svg%3e\",\r\n  userAvatar:\r\n    \"data:image/svg+xml,%3csvg viewBox='-208.5 21 100 100' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3ccircle cx='-158.5' cy='71' fill='%23F5EEE5' r='50'/%3e%3cdefs%3e%3ccircle cx='-158.5' cy='71' id='a' r='50'/%3e%3c/defs%3e%3cclipPath id='b'%3e%3cuse overflow='visible' xlink:href='%23a'/%3e%3c/clipPath%3e%3cpath clip-path='url(%23b)' d='M-108.5 121v-14s-21.2-4.9-28-6.7c-2.5-.7-7-3.3-7-12V82h-30v6.3c0 8.7-4.5 11.3-7 12-6.8 1.9-28.1 7.3-28.1 6.7v14h100.1z' fill='%23E6C19C'/%3e%3cg clip-path='url(%23b)'%3e%3cdefs%3e%3cpath d='M-108.5 121v-14s-21.2-4.9-28-6.7c-2.5-.7-7-3.3-7-12V82h-30v6.3c0 8.7-4.5 11.3-7 12-6.8 1.9-28.1 7.3-28.1 6.7v14h100.1z' id='c'/%3e%3c/defs%3e%3cclipPath id='d'%3e%3cuse overflow='visible' xlink:href='%23c'/%3e%3c/clipPath%3e%3cpath clip-path='url(%23d)' d='M-158.5 100.1c12.7 0 23-18.6 23-34.4 0-16.2-10.3-24.7-23-24.7s-23 8.5-23 24.7c0 15.8 10.3 34.4 23 34.4z' fill='%23D4B08C'/%3e%3c/g%3e%3cpath d='M-158.5 96c12.7 0 23-16.3 23-31 0-15.1-10.3-23-23-23s-23 7.9-23 23c0 14.7 10.3 31 23 31z' fill='%23F2CEA5'/%3e%3c/svg%3e\"\r\n};\r\n\r\nexport default ChatBot;\r\n"]},"metadata":{},"sourceType":"module"}