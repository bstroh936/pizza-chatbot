{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\TheTOP\\\\Documents\\\\GitHub\\\\pizza-chatbot-chk4\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"C:\\\\Users\\\\TheTOP\\\\Documents\\\\GitHub\\\\pizza-chatbot-chk4\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\TheTOP\\\\Documents\\\\GitHub\\\\pizza-chatbot-chk4\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\TheTOP\\\\Documents\\\\GitHub\\\\pizza-chatbot-chk4\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\TheTOP\\\\Documents\\\\GitHub\\\\pizza-chatbot-chk4\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from'react';import Random from'random-id';import{CustomStep,OptionsStep,TextStep}from'./steps_components';import schema from'./schemas/schema';import*as storage from'./storage';import{ChatBotContainer,Content,Header,HeaderTitle,HeaderIcon,FloatButton,FloatingIcon,Footer,Input,SubmitButton}from'./components';import Recognition from'./recognition';import{ChatIcon,CloseIcon,SubmitIcon,MicIcon}from'./icons';import{isMobile}from'./utils';import{speakFn}from'./speechSynthesis';var ChatBot=/*#__PURE__*/function(_Component){_inherits(ChatBot,_Component);var _super=_createSuper(ChatBot);/* istanbul ignore next */function ChatBot(props){var _this;_classCallCheck(this,ChatBot);_this=_super.call(this,props);_this.onNodeInserted=function(event){var target=event.currentTarget;var enableSmoothScroll=_this.props.enableSmoothScroll;if(enableSmoothScroll&&_this.supportsScrollBehavior){target.scroll({top:target.scrollHeight,left:0,behavior:'smooth'});}else{target.scrollTop=target.scrollHeight;}};_this.onResize=function(){_this.content.scrollTop=_this.content.scrollHeight;};_this.onRecognitionChange=function(value){_this.setState({inputValue:value});};_this.onRecognitionEnd=function(){_this.setState({speaking:false});_this.handleSubmitButton();};_this.onRecognitionStop=function(){_this.setState({speaking:false});};_this.onValueChange=function(event){_this.setState({inputValue:event.target.value});};_this.getTriggeredStep=function(trigger,value){var steps=_this.generateRenderedStepsById();return typeof trigger==='function'?trigger({value:value,steps:steps}):trigger;};_this.getStepMessage=function(message){var previousSteps=_this.state.previousSteps;var lastStepIndex=previousSteps.length>0?previousSteps.length-1:0;var steps=_this.generateRenderedStepsById();var previousValue=previousSteps[lastStepIndex].value;return typeof message==='function'?message({previousValue:previousValue,steps:steps}):message;};_this.generateRenderedStepsById=function(){var previousSteps=_this.state.previousSteps;var steps={};for(var i=0,len=previousSteps.length;i<len;i+=1){var _previousSteps$i=previousSteps[i],id=_previousSteps$i.id,message=_previousSteps$i.message,value=_previousSteps$i.value,metadata=_previousSteps$i.metadata;steps[id]={id:id,message:message,value:value,metadata:metadata};}return steps;};_this.triggerNextStep=function(data){var enableMobileAutoFocus=_this.props.enableMobileAutoFocus;var _this$state=_this.state,defaultUserSettings=_this$state.defaultUserSettings,previousSteps=_this$state.previousSteps,renderedSteps=_this$state.renderedSteps,steps=_this$state.steps;var _this$state2=_this.state,currentStep=_this$state2.currentStep,previousStep=_this$state2.previousStep;var isEnd=currentStep.end;if(data&&data.value){currentStep.value=data.value;}if(data&&data.hideInput){currentStep.hideInput=data.hideInput;}if(data&&data.hideExtraControl){currentStep.hideExtraControl=data.hideExtraControl;}if(data&&data.trigger){currentStep.trigger=_this.getTriggeredStep(data.trigger,data.value);}if(isEnd){_this.handleEnd();}else if(currentStep.options&&data){var option=currentStep.options.filter(function(o){return o.value===data.value;})[0];var trigger=_this.getTriggeredStep(option.trigger,currentStep.value);delete currentStep.options;// replace choose option for user message\ncurrentStep=Object.assign({},currentStep,option,defaultUserSettings,{user:true,message:option.label,trigger:trigger});renderedSteps.pop();previousSteps.pop();renderedSteps.push(currentStep);previousSteps.push(currentStep);_this.setState({currentStep:currentStep,renderedSteps:renderedSteps,previousSteps:previousSteps});}else if(currentStep.trigger&&currentStep.replace&&data){var _trigger=_this.getTriggeredStep(currentStep.trigger,currentStep.value);var val=currentStep.value;var msg=data.msg;var stepMsg=data.stepMsg;delete currentStep.component;if(data.preserveMsg){var defaultBotSettings={delay:0,avatar:_this.props.botAvatar,botName:_this.props.botName};var thisStepMsg={id:currentStep.id,key:currentStep.key,msg:stepMsg,trigger:''};var nextS=Object.assign({},thisStepMsg,0,defaultBotSettings,{user:false,message:stepMsg,rendered:true});delete currentStep.component;delete currentStep.trigger;currentStep=Object.assign({},currentStep,val,defaultUserSettings,{user:true,message:msg,trigger:_trigger});renderedSteps.pop();previousSteps.pop();renderedSteps.push(nextS);previousSteps.push(nextS);renderedSteps.push(currentStep);previousSteps.push(currentStep);_this.setState({currentStep:currentStep,renderedSteps:renderedSteps,previousSteps:previousSteps});}else{delete currentStep.component;currentStep=Object.assign({},currentStep,val,defaultUserSettings,{user:true,message:msg,trigger:_trigger});renderedSteps.pop();previousSteps.pop();renderedSteps.push(currentStep);previousSteps.push(currentStep);_this.setState({currentStep:currentStep,renderedSteps:renderedSteps,previousSteps:previousSteps});}}else if(currentStep.trigger){var _trigger2=_this.getTriggeredStep(currentStep.trigger,currentStep.value);var nextStep=Object.assign({},steps[_trigger2]);if(nextStep.message){nextStep.message=_this.getStepMessage(nextStep.message);}else if(nextStep.update){var updateStep=nextStep;nextStep=Object.assign({},steps[updateStep.update]);if(nextStep.options){for(var i=0,len=nextStep.options.length;i<len;i+=1){nextStep.options[i].trigger=updateStep.trigger;}}else{nextStep.trigger=updateStep.trigger;}}nextStep.key=Random(24);previousStep=currentStep;currentStep=nextStep;_this.setState({renderedSteps:renderedSteps,currentStep:currentStep,previousStep:previousStep},function(){if(nextStep.user){_this.setState({disabled:false},function(){if(enableMobileAutoFocus||!isMobile()){if(_this.input){_this.input.focus();}}});}else{renderedSteps.push(nextStep);previousSteps.push(nextStep);_this.setState({renderedSteps:renderedSteps,previousSteps:previousSteps});}});}var _this$props=_this.props,cache=_this$props.cache,cacheName=_this$props.cacheName;if(cache){setTimeout(function(){storage.setData(cacheName,{currentStep:currentStep,previousStep:previousStep,previousSteps:previousSteps,renderedSteps:renderedSteps});},300);}};_this.handleEnd=function(){var handleEnd=_this.props.handleEnd;if(handleEnd){var previousSteps=_this.state.previousSteps;var renderedSteps=previousSteps.map(function(step){var id=step.id,message=step.message,value=step.value,metadata=step.metadata;return{id:id,message:message,value:value,metadata:metadata};});var steps=[];for(var i=0,len=previousSteps.length;i<len;i+=1){var _previousSteps$i2=previousSteps[i],id=_previousSteps$i2.id,message=_previousSteps$i2.message,value=_previousSteps$i2.value,metadata=_previousSteps$i2.metadata;steps[id]={id:id,message:message,value:value,metadata:metadata};}var values=previousSteps.filter(function(step){return step.value;}).map(function(step){return step.value;});handleEnd({renderedSteps:renderedSteps,steps:steps,values:values});}};_this.isInputValueEmpty=function(){var inputValue=_this.state.inputValue;return!inputValue||inputValue.length===0;};_this.isLastPosition=function(step){var renderedSteps=_this.state.renderedSteps;var length=renderedSteps.length;var stepIndex=renderedSteps.map(function(s){return s.key;}).indexOf(step.key);if(length<=1||stepIndex+1===length){return true;}var nextStep=renderedSteps[stepIndex+1];var hasMessage=nextStep.message||nextStep.asMessage;if(!hasMessage){return true;}var isLast=step.user!==nextStep.user;return isLast;};_this.isFirstPosition=function(step){var renderedSteps=_this.state.renderedSteps;var stepIndex=renderedSteps.map(function(s){return s.key;}).indexOf(step.key);if(stepIndex===0){return true;}var lastStep=renderedSteps[stepIndex-1];var hasMessage=lastStep.message||lastStep.asMessage;if(!hasMessage){return true;}var isFirst=step.user!==lastStep.user;return isFirst;};_this.handleKeyPress=function(event){if(event.key==='Enter'){_this.submitUserMessage();}};_this.handleSubmitButton=function(){var _this$state3=_this.state,speaking=_this$state3.speaking,recognitionEnable=_this$state3.recognitionEnable;if((_this.isInputValueEmpty()||speaking)&&recognitionEnable){_this.recognition.speak();if(!speaking){_this.setState({speaking:true});}return;}_this.submitUserMessage();};_this.submitUserMessage=function(){var _this$state4=_this.state,defaultUserSettings=_this$state4.defaultUserSettings,inputValue=_this$state4.inputValue,previousSteps=_this$state4.previousSteps,renderedSteps=_this$state4.renderedSteps;var currentStep=_this.state.currentStep;var isInvalid=currentStep.validator&&_this.checkInvalidInput();if(!isInvalid){var step={message:inputValue,value:inputValue};currentStep=Object.assign({},defaultUserSettings,currentStep,step);renderedSteps.push(currentStep);previousSteps.push(currentStep);_this.setState({currentStep:currentStep,renderedSteps:renderedSteps,previousSteps:previousSteps,disabled:true,inputValue:''},function(){if(_this.input){_this.input.blur();}});}};_this.checkInvalidInput=function(){var enableMobileAutoFocus=_this.props.enableMobileAutoFocus;var _this$state5=_this.state,currentStep=_this$state5.currentStep,inputValue=_this$state5.inputValue;var result=currentStep.validator(inputValue);var value=inputValue;if(typeof result!=='boolean'||!result){_this.setState({inputValue:result.toString(),inputInvalid:true,disabled:true},function(){setTimeout(function(){_this.setState({inputValue:value,inputInvalid:false,disabled:false},function(){if(enableMobileAutoFocus||!isMobile()){if(_this.input){_this.input.focus();}}});},2000);});return true;}return false;};_this.toggleChatBot=function(opened){var toggleFloating=_this.props.toggleFloating;if(toggleFloating){toggleFloating({opened:opened});}else{_this.setState({opened:opened});}};_this.renderStep=function(step,index){var renderedSteps=_this.state.renderedSteps;var _this$props2=_this.props,avatarStyle=_this$props2.avatarStyle,bubbleStyle=_this$props2.bubbleStyle,bubbleOptionStyle=_this$props2.bubbleOptionStyle,customStyle=_this$props2.customStyle,hideBotAvatar=_this$props2.hideBotAvatar,hideUserAvatar=_this$props2.hideUserAvatar,speechSynthesis=_this$props2.speechSynthesis;var options=step.options,component=step.component,asMessage=step.asMessage;var steps=_this.generateRenderedStepsById();var previousStep=index>0?renderedSteps[index-1]:{};if(component&&!asMessage){return/*#__PURE__*/React.createElement(CustomStep,{key:index,speak:_this.speak,step:step,steps:steps,style:customStyle,previousStep:previousStep,previousValue:previousStep.value,triggerNextStep:_this.triggerNextStep});}if(options){return/*#__PURE__*/React.createElement(OptionsStep,{key:index,step:step,previousValue:previousStep.value,triggerNextStep:_this.triggerNextStep,bubbleOptionStyle:bubbleOptionStyle});}return/*#__PURE__*/React.createElement(TextStep,{key:index,step:step,steps:steps,speak:_this.speak,previousStep:previousStep,previousValue:previousStep.value,triggerNextStep:_this.triggerNextStep,avatarStyle:avatarStyle,bubbleStyle:bubbleStyle,hideBotAvatar:hideBotAvatar,hideUserAvatar:hideUserAvatar,speechSynthesis:speechSynthesis,isFirst:_this.isFirstPosition(step),isLast:_this.isLastPosition(step)});};_this.content=null;_this.input=null;_this.supportsScrollBehavior=false;_this.setContentRef=function(element){_this.content=element;};_this.setInputRef=function(element){_this.input=element;};_this.state={renderedSteps:[],previousSteps:[],currentStep:{},previousStep:{},steps:{},disabled:true,opened:props.opened||!props.floating,inputValue:'',inputInvalid:false,speaking:false,recognitionEnable:props.recognitionEnable&&Recognition.isSupported(),defaultUserSettings:{}};_this.speak=speakFn(props.speechSynthesis);return _this;}_createClass(ChatBot,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var steps=this.props.steps;var _this$props3=this.props,botDelay=_this$props3.botDelay,botAvatar=_this$props3.botAvatar,botName=_this$props3.botName,cache=_this$props3.cache,cacheName=_this$props3.cacheName,customDelay=_this$props3.customDelay,enableMobileAutoFocus=_this$props3.enableMobileAutoFocus,userAvatar=_this$props3.userAvatar,userDelay=_this$props3.userDelay;var chatSteps={};var defaultBotSettings={delay:botDelay,avatar:botAvatar,botName:botName};var defaultUserSettings={delay:userDelay,avatar:userAvatar,hideInput:false,hideExtraControl:false};var defaultCustomSettings={delay:customDelay};for(var i=0,len=steps.length;i<len;i+=1){var step=steps[i];var settings={};if(step.user){settings=defaultUserSettings;}else if(step.message||step.asMessage){settings=defaultBotSettings;}else if(step.component){settings=defaultCustomSettings;}chatSteps[step.id]=Object.assign({},settings,schema.parse(step));}schema.checkInvalidIds(chatSteps);var firstStep=steps[0];if(firstStep.message){var message=firstStep.message;firstStep.message=typeof message==='function'?message():message;chatSteps[firstStep.id].message=firstStep.message;}var recognitionEnable=this.state.recognitionEnable;var recognitionLang=this.props.recognitionLang;if(recognitionEnable){this.recognition=new Recognition(this.onRecognitionChange,this.onRecognitionEnd,this.onRecognitionStop,recognitionLang);}this.supportsScrollBehavior='scrollBehavior'in document.documentElement.style;if(this.content){this.content.addEventListener('DOMNodeInserted',this.onNodeInserted);window.addEventListener('resize',this.onResize);}var _storage$getData=storage.getData({cacheName:cacheName,cache:cache,firstStep:firstStep,steps:chatSteps},function(){// focus input if last step cached is a user step\n_this2.setState({disabled:false},function(){if(enableMobileAutoFocus||!isMobile()){if(_this2.input){_this2.input.focus();}}});}),currentStep=_storage$getData.currentStep,previousStep=_storage$getData.previousStep,previousSteps=_storage$getData.previousSteps,renderedSteps=_storage$getData.renderedSteps;this.setState({currentStep:currentStep,defaultUserSettings:defaultUserSettings,previousStep:previousStep,previousSteps:previousSteps,renderedSteps:renderedSteps,steps:chatSteps});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){if(this.content){this.content.removeEventListener('DOMNodeInserted',this.onNodeInserted);window.removeEventListener('resize',this.onResize);}}},{key:\"render\",value:function render(){var _this3=this;var _this$state6=this.state,currentStep=_this$state6.currentStep,disabled=_this$state6.disabled,inputInvalid=_this$state6.inputInvalid,inputValue=_this$state6.inputValue,opened=_this$state6.opened,renderedSteps=_this$state6.renderedSteps,speaking=_this$state6.speaking,recognitionEnable=_this$state6.recognitionEnable;var _this$props4=this.props,className=_this$props4.className,contentStyle=_this$props4.contentStyle,extraControl=_this$props4.extraControl,controlStyle=_this$props4.controlStyle,floating=_this$props4.floating,floatingIcon=_this$props4.floatingIcon,floatingStyle=_this$props4.floatingStyle,footerStyle=_this$props4.footerStyle,headerComponent=_this$props4.headerComponent,headerTitle=_this$props4.headerTitle,hideHeader=_this$props4.hideHeader,hideSubmitButton=_this$props4.hideSubmitButton,inputStyle=_this$props4.inputStyle,placeholder=_this$props4.placeholder,inputAttributes=_this$props4.inputAttributes,recognitionPlaceholder=_this$props4.recognitionPlaceholder,style=_this$props4.style,submitButtonStyle=_this$props4.submitButtonStyle,width=_this$props4.width,height=_this$props4.height;var header=headerComponent||/*#__PURE__*/React.createElement(Header,{className:\"rsc-header\"},/*#__PURE__*/React.createElement(HeaderTitle,{className:\"rsc-header-title\"},headerTitle),floating&&/*#__PURE__*/React.createElement(HeaderIcon,{className:\"rsc-header-close-button\",onClick:function onClick(){return _this3.toggleChatBot(false);}},/*#__PURE__*/React.createElement(CloseIcon,null)));var customControl;if(extraControl!==undefined){customControl=React.cloneElement(extraControl,{disabled:disabled,speaking:speaking,invalid:inputInvalid});}var icon=(this.isInputValueEmpty()||speaking)&&recognitionEnable?/*#__PURE__*/React.createElement(MicIcon,null):/*#__PURE__*/React.createElement(SubmitIcon,null);var inputPlaceholder=speaking?recognitionPlaceholder:currentStep.placeholder||placeholder;var inputAttributesOverride=currentStep.inputAttributes||inputAttributes;return/*#__PURE__*/React.createElement(\"div\",{className:\"rsc \".concat(className)},floating&&/*#__PURE__*/React.createElement(FloatButton,{className:\"rsc-float-button\",style:floatingStyle,opened:opened,onClick:function onClick(){return _this3.toggleChatBot(true);}},typeof floatingIcon==='string'?/*#__PURE__*/React.createElement(FloatingIcon,{src:floatingIcon}):floatingIcon),/*#__PURE__*/React.createElement(ChatBotContainer,{className:\"rsc-container\",floating:floating,floatingStyle:floatingStyle,opened:opened,style:style,width:width,height:height},!hideHeader&&header,/*#__PURE__*/React.createElement(Content,{className:\"rsc-content\",ref:this.setContentRef,floating:floating,style:contentStyle,height:height,hideInput:currentStep.hideInput},renderedSteps.map(this.renderStep)),/*#__PURE__*/React.createElement(Footer,{className:\"rsc-footer\",style:footerStyle},!currentStep.hideInput&&/*#__PURE__*/React.createElement(Input,Object.assign({type:\"textarea\",style:inputStyle,ref:this.setInputRef,className:\"rsc-input\",placeholder:inputInvalid?'':inputPlaceholder,onKeyPress:this.handleKeyPress,onChange:this.onValueChange,value:inputValue,floating:floating,invalid:inputInvalid,disabled:disabled,hasButton:!hideSubmitButton},inputAttributesOverride)),/*#__PURE__*/React.createElement(\"div\",{style:controlStyle,className:\"rsc-controls\"},!currentStep.hideInput&&!currentStep.hideExtraControl&&customControl,!currentStep.hideInput&&!hideSubmitButton&&/*#__PURE__*/React.createElement(SubmitButton,{className:\"rsc-submit-button\",style:submitButtonStyle,onClick:this.handleSubmitButton,invalid:inputInvalid,disabled:disabled,speaking:speaking},icon)))));}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){var opened=props.opened,toggleFloating=props.toggleFloating;if(toggleFloating!==undefined&&opened!==undefined&&opened!==state.opened){return _objectSpread(_objectSpread({},state),{},{opened:opened});}return state;}}]);return ChatBot;}(Component);ChatBot.defaultProps={avatarStyle:{},botDelay:1000,botName:'The bot',bubbleOptionStyle:{},bubbleStyle:{},cache:false,cacheName:'rsc_cache',className:'',contentStyle:{},customStyle:{},controlStyle:{position:'absolute',right:'0',top:'0'},customDelay:1000,enableMobileAutoFocus:false,enableSmoothScroll:false,extraControl:undefined,floating:false,floatingIcon:/*#__PURE__*/React.createElement(ChatIcon,null),floatingStyle:{},footerStyle:{},handleEnd:undefined,headerComponent:undefined,headerTitle:'Chat',height:'520px',hideBotAvatar:false,hideHeader:false,hideSubmitButton:false,hideUserAvatar:false,inputStyle:{},opened:undefined,placeholder:'Type the message ...',inputAttributes:{},recognitionEnable:false,recognitionLang:'en',recognitionPlaceholder:'Listening ...',speechSynthesis:{enable:false,lang:'en',voice:null},style:{},submitButtonStyle:{},toggleFloating:undefined,userDelay:1000,width:'350px',botAvatar:\"data:image/svg+xml,%3csvg version='1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3e%3cpath d='M303 70a47 47 0 1 0-70 40v84h46v-84c14-8 24-23 24-40z' fill='%2393c7ef'/%3e%3cpath d='M256 23v171h23v-84a47 47 0 0 0-23-87z' fill='%235a8bb0'/%3e%3cpath fill='%2393c7ef' d='M0 240h248v124H0z'/%3e%3cpath fill='%235a8bb0' d='M264 240h248v124H264z'/%3e%3cpath fill='%2393c7ef' d='M186 365h140v124H186z'/%3e%3cpath fill='%235a8bb0' d='M256 365h70v124h-70z'/%3e%3cpath fill='%23cce9f9' d='M47 163h419v279H47z'/%3e%3cpath fill='%2393c7ef' d='M256 163h209v279H256z'/%3e%3cpath d='M194 272a31 31 0 0 1-62 0c0-18 14-32 31-32s31 14 31 32z' fill='%233c5d76'/%3e%3cpath d='M380 272a31 31 0 0 1-62 0c0-18 14-32 31-32s31 14 31 32z' fill='%231e2e3b'/%3e%3cpath d='M186 349a70 70 0 1 0 140 0H186z' fill='%233c5d76'/%3e%3cpath d='M256 349v70c39 0 70-31 70-70h-70z' fill='%231e2e3b'/%3e%3c/svg%3e\",userAvatar:\"data:image/svg+xml,%3csvg viewBox='-208.5 21 100 100' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3ccircle cx='-158.5' cy='71' fill='%23F5EEE5' r='50'/%3e%3cdefs%3e%3ccircle cx='-158.5' cy='71' id='a' r='50'/%3e%3c/defs%3e%3cclipPath id='b'%3e%3cuse overflow='visible' xlink:href='%23a'/%3e%3c/clipPath%3e%3cpath clip-path='url(%23b)' d='M-108.5 121v-14s-21.2-4.9-28-6.7c-2.5-.7-7-3.3-7-12V82h-30v6.3c0 8.7-4.5 11.3-7 12-6.8 1.9-28.1 7.3-28.1 6.7v14h100.1z' fill='%23E6C19C'/%3e%3cg clip-path='url(%23b)'%3e%3cdefs%3e%3cpath d='M-108.5 121v-14s-21.2-4.9-28-6.7c-2.5-.7-7-3.3-7-12V82h-30v6.3c0 8.7-4.5 11.3-7 12-6.8 1.9-28.1 7.3-28.1 6.7v14h100.1z' id='c'/%3e%3c/defs%3e%3cclipPath id='d'%3e%3cuse overflow='visible' xlink:href='%23c'/%3e%3c/clipPath%3e%3cpath clip-path='url(%23d)' d='M-158.5 100.1c12.7 0 23-18.6 23-34.4 0-16.2-10.3-24.7-23-24.7s-23 8.5-23 24.7c0 15.8 10.3 34.4 23 34.4z' fill='%23D4B08C'/%3e%3c/g%3e%3cpath d='M-158.5 96c12.7 0 23-16.3 23-31 0-15.1-10.3-23-23-23s-23 7.9-23 23c0 14.7 10.3 31 23 31z' fill='%23F2CEA5'/%3e%3c/svg%3e\"};export default ChatBot;","map":{"version":3,"sources":["C:/Users/TheTOP/Documents/GitHub/pizza-chatbot-chk4/src/components/chatbot/ChatBot.jsx"],"names":["React","Component","Random","CustomStep","OptionsStep","TextStep","schema","storage","ChatBotContainer","Content","Header","HeaderTitle","HeaderIcon","FloatButton","FloatingIcon","Footer","Input","SubmitButton","Recognition","ChatIcon","CloseIcon","SubmitIcon","MicIcon","isMobile","speakFn","ChatBot","props","onNodeInserted","event","target","currentTarget","enableSmoothScroll","supportsScrollBehavior","scroll","top","scrollHeight","left","behavior","scrollTop","onResize","content","onRecognitionChange","value","setState","inputValue","onRecognitionEnd","speaking","handleSubmitButton","onRecognitionStop","onValueChange","getTriggeredStep","trigger","steps","generateRenderedStepsById","getStepMessage","message","previousSteps","state","lastStepIndex","length","previousValue","i","len","id","metadata","triggerNextStep","data","enableMobileAutoFocus","defaultUserSettings","renderedSteps","currentStep","previousStep","isEnd","end","hideInput","hideExtraControl","handleEnd","options","option","filter","o","Object","assign","user","label","pop","push","replace","val","msg","stepMsg","component","preserveMsg","defaultBotSettings","delay","avatar","botAvatar","botName","thisStepMsg","key","nextS","rendered","nextStep","update","updateStep","disabled","input","focus","cache","cacheName","setTimeout","setData","map","step","values","isInputValueEmpty","isLastPosition","stepIndex","s","indexOf","hasMessage","asMessage","isLast","isFirstPosition","lastStep","isFirst","handleKeyPress","submitUserMessage","recognitionEnable","recognition","speak","isInvalid","validator","checkInvalidInput","blur","result","toString","inputInvalid","toggleChatBot","opened","toggleFloating","renderStep","index","avatarStyle","bubbleStyle","bubbleOptionStyle","customStyle","hideBotAvatar","hideUserAvatar","speechSynthesis","setContentRef","element","setInputRef","floating","isSupported","botDelay","customDelay","userAvatar","userDelay","chatSteps","defaultCustomSettings","settings","parse","checkInvalidIds","firstStep","recognitionLang","document","documentElement","style","addEventListener","window","getData","removeEventListener","className","contentStyle","extraControl","controlStyle","floatingIcon","floatingStyle","footerStyle","headerComponent","headerTitle","hideHeader","hideSubmitButton","inputStyle","placeholder","inputAttributes","recognitionPlaceholder","submitButtonStyle","width","height","header","customControl","undefined","cloneElement","invalid","icon","inputPlaceholder","inputAttributesOverride","defaultProps","position","right","enable","lang","voice"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Random from 'random-id';\nimport { CustomStep, OptionsStep, TextStep } from './steps_components';\nimport schema from './schemas/schema';\nimport * as storage from './storage';\nimport {\n  ChatBotContainer,\n  Content,\n  Header,\n  HeaderTitle,\n  HeaderIcon,\n  FloatButton,\n  FloatingIcon,\n  Footer,\n  Input,\n  SubmitButton\n} from './components';\nimport Recognition from './recognition';\nimport { ChatIcon, CloseIcon, SubmitIcon, MicIcon } from './icons';\nimport { isMobile } from './utils';\nimport { speakFn } from './speechSynthesis';\n\nclass ChatBot extends Component {\n  /* istanbul ignore next */\n  constructor(props) {\n    super(props);\n\n    this.content = null;\n    this.input = null;\n\n    this.supportsScrollBehavior = false;\n\n    this.setContentRef = element => {\n      this.content = element;\n    };\n\n    this.setInputRef = element => {\n      this.input = element;\n    };\n\n    this.state = {\n      renderedSteps: [],\n      previousSteps: [],\n      currentStep: {},\n      previousStep: {},\n      steps: {},\n      disabled: true,\n      opened: props.opened || !props.floating,\n      inputValue: '',\n      inputInvalid: false,\n      speaking: false,\n      recognitionEnable: props.recognitionEnable && Recognition.isSupported(),\n      defaultUserSettings: {}\n    };\n\n    this.speak = speakFn(props.speechSynthesis);\n  }\n\n  componentDidMount() {\n    const { steps } = this.props;\n    const {\n      botDelay,\n      botAvatar,\n      botName,\n      cache,\n      cacheName,\n      customDelay,\n      enableMobileAutoFocus,\n      userAvatar,\n      userDelay\n    } = this.props;\n    const chatSteps = {};\n\n    const defaultBotSettings = { delay: botDelay, avatar: botAvatar, botName };\n    const defaultUserSettings = {\n      delay: userDelay,\n      avatar: userAvatar,\n      hideInput: false,\n      hideExtraControl: false\n    };\n    const defaultCustomSettings = { delay: customDelay };\n\n    for (let i = 0, len = steps.length; i < len; i += 1) {\n      const step = steps[i];\n      let settings = {};\n\n      if (step.user) {\n        settings = defaultUserSettings;\n      } else if (step.message || step.asMessage) {\n        settings = defaultBotSettings;\n      } else if (step.component) {\n        settings = defaultCustomSettings;\n      }\n\n      chatSteps[step.id] = Object.assign({}, settings, schema.parse(step));\n    }\n\n    schema.checkInvalidIds(chatSteps);\n\n    const firstStep = steps[0];\n\n    if (firstStep.message) {\n      const { message } = firstStep;\n      firstStep.message = typeof message === 'function' ? message() : message;\n      chatSteps[firstStep.id].message = firstStep.message;\n    }\n\n    const { recognitionEnable } = this.state;\n    const { recognitionLang } = this.props;\n\n    if (recognitionEnable) {\n      this.recognition = new Recognition(\n        this.onRecognitionChange,\n        this.onRecognitionEnd,\n        this.onRecognitionStop,\n        recognitionLang\n      );\n    }\n\n    this.supportsScrollBehavior = 'scrollBehavior' in document.documentElement.style;\n\n    if (this.content) {\n      this.content.addEventListener('DOMNodeInserted', this.onNodeInserted);\n      window.addEventListener('resize', this.onResize);\n    }\n\n    const { currentStep, previousStep, previousSteps, renderedSteps } = storage.getData(\n      {\n        cacheName,\n        cache,\n        firstStep,\n        steps: chatSteps\n      },\n      () => {\n        // focus input if last step cached is a user step\n        this.setState({ disabled: false }, () => {\n          if (enableMobileAutoFocus || !isMobile()) {\n            if (this.input) {\n              this.input.focus();\n            }\n          }\n        });\n      }\n    );\n\n    this.setState({\n      currentStep,\n      defaultUserSettings,\n      previousStep,\n      previousSteps,\n      renderedSteps,\n      steps: chatSteps\n    });\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    const { opened, toggleFloating } = props;\n    if (toggleFloating !== undefined && opened !== undefined && opened !== state.opened) {\n      return {\n        ...state,\n        opened\n      };\n    }\n    return state;\n  }\n\n  componentWillUnmount() {\n    if (this.content) {\n      this.content.removeEventListener('DOMNodeInserted', this.onNodeInserted);\n      window.removeEventListener('resize', this.onResize);\n    }\n  }\n\n  onNodeInserted = event => {\n    const { currentTarget: target } = event;\n    const { enableSmoothScroll } = this.props;\n\n    if (enableSmoothScroll && this.supportsScrollBehavior) {\n      target.scroll({\n        top: target.scrollHeight,\n        left: 0,\n        behavior: 'smooth'\n      });\n    } else {\n      target.scrollTop = target.scrollHeight;\n    }\n  };\n\n  onResize = () => {\n    this.content.scrollTop = this.content.scrollHeight;\n  };\n\n  onRecognitionChange = value => {\n    this.setState({ inputValue: value });\n  };\n\n  onRecognitionEnd = () => {\n    this.setState({ speaking: false });\n    this.handleSubmitButton();\n  };\n\n  onRecognitionStop = () => {\n    this.setState({ speaking: false });\n  };\n\n  onValueChange = event => {\n    this.setState({ inputValue: event.target.value });\n  };\n\n  getTriggeredStep = (trigger, value) => {\n    const steps = this.generateRenderedStepsById();\n    return typeof trigger === 'function' ? trigger({ value, steps }) : trigger;\n  };\n\n  getStepMessage = message => {\n    const { previousSteps } = this.state;\n    const lastStepIndex = previousSteps.length > 0 ? previousSteps.length - 1 : 0;\n    const steps = this.generateRenderedStepsById();\n    const previousValue = previousSteps[lastStepIndex].value;\n    return typeof message === 'function' ? message({ previousValue, steps }) : message;\n  };\n\n  generateRenderedStepsById = () => {\n    const { previousSteps } = this.state;\n    const steps = {};\n\n    for (let i = 0, len = previousSteps.length; i < len; i += 1) {\n      const { id, message, value, metadata } = previousSteps[i];\n\n      steps[id] = {\n        id,\n        message,\n        value,\n        metadata\n      };\n    }\n\n    return steps;\n  };\n\n  triggerNextStep = data => {\n    const { enableMobileAutoFocus } = this.props;\n    const { defaultUserSettings, previousSteps, renderedSteps, steps } = this.state;\n\n    let { currentStep, previousStep } = this.state;\n    const isEnd = currentStep.end;\n\n    if (data && data.value) {\n      currentStep.value = data.value;\n    }\n    if (data && data.hideInput) {\n      currentStep.hideInput = data.hideInput;\n    }\n    if (data && data.hideExtraControl) {\n      currentStep.hideExtraControl = data.hideExtraControl;\n    }\n    if (data && data.trigger) {\n      currentStep.trigger = this.getTriggeredStep(data.trigger, data.value);\n    }\n\n    if (isEnd) {\n      this.handleEnd();\n    } else if (currentStep.options && data) {\n      const option = currentStep.options.filter(o => o.value === data.value)[0];\n      const trigger = this.getTriggeredStep(option.trigger, currentStep.value);\n      delete currentStep.options;\n      \n      // replace choose option for user message\n      currentStep = Object.assign({}, currentStep, option, defaultUserSettings, {\n        user: true,\n        message: option.label,\n        trigger\n      });     \n      renderedSteps.pop();\n      previousSteps.pop();\n      renderedSteps.push(currentStep);\n      previousSteps.push(currentStep);\n\n      this.setState({\n        currentStep,\n        renderedSteps,\n        previousSteps\n      });\n    } else if (currentStep.trigger && currentStep.replace && data) {\n        const trigger = this.getTriggeredStep(currentStep.trigger, currentStep.value);      \n        const val = currentStep.value;\n        const msg = data.msg;\n        const stepMsg = data.stepMsg;\n\n        delete currentStep.component;  \n        if(data.preserveMsg){\n          const defaultBotSettings = { delay: 0, avatar: this.props.botAvatar, botName: this.props.botName };\n         \n          const thisStepMsg = {id:currentStep.id, key: currentStep.key, msg: stepMsg, trigger: ''};\n          const nextS = Object.assign({}, thisStepMsg, 0, defaultBotSettings, {\n            user: false,\n            message: stepMsg,\n            rendered:true,\n            \n          }); \n          delete currentStep.component;\n          delete currentStep.trigger;\n\n          currentStep = Object.assign({}, currentStep, val, defaultUserSettings, {\n            user: true,\n            message: msg,\n            trigger: trigger,            \n          });\n          renderedSteps.pop();\n          previousSteps.pop();\n          renderedSteps.push(nextS);\n          previousSteps.push(nextS);\n          renderedSteps.push(currentStep);\n          previousSteps.push(currentStep);\n          this.setState({\n            currentStep,\n            renderedSteps,\n            previousSteps\n          });\n        } else {\n          delete currentStep.component;    \n          currentStep = Object.assign({}, currentStep, val, defaultUserSettings, {\n            user: true,\n            message: msg,\n            trigger\n          }); \n          \n          renderedSteps.pop();\n          previousSteps.pop();\n          renderedSteps.push(currentStep);\n          previousSteps.push(currentStep);\n          \n          this.setState({\n            currentStep,\n            renderedSteps,\n            previousSteps\n          });\n        }\n      } else if (currentStep.trigger) {      \n      \n       const trigger = this.getTriggeredStep(currentStep.trigger, currentStep.value);  \n        let nextStep = Object.assign({}, steps[trigger]);\n     \n      if (nextStep.message) {\n        nextStep.message = this.getStepMessage(nextStep.message);\n      } else if (nextStep.update) {\n        const updateStep = nextStep;\n        nextStep = Object.assign({}, steps[updateStep.update]);\n\n        if (nextStep.options) {\n          for (let i = 0, len = nextStep.options.length; i < len; i += 1) {\n            nextStep.options[i].trigger = updateStep.trigger;\n          }\n        } else {\n          nextStep.trigger = updateStep.trigger;\n        }\n      }\n\n      nextStep.key = Random(24);\n\n      previousStep = currentStep;\n      currentStep = nextStep;\n\n      this.setState({ renderedSteps, currentStep, previousStep }, () => {\n        if (nextStep.user) {\n          this.setState({ disabled: false }, () => {\n            if (enableMobileAutoFocus || !isMobile()) {\n              if (this.input) {\n                this.input.focus();\n              }\n            }\n          });\n        } else {\n          renderedSteps.push(nextStep);\n          previousSteps.push(nextStep);\n\n          this.setState({ renderedSteps, previousSteps });\n        }\n      });\n    }\n\n    const { cache, cacheName } = this.props;\n    if (cache) {\n      setTimeout(() => {\n        storage.setData(cacheName, {\n          currentStep,\n          previousStep,\n          previousSteps,\n          renderedSteps\n        });\n      }, 300);\n    }\n  };\n\n  handleEnd = () => {\n    const { handleEnd } = this.props;\n\n    if (handleEnd) {\n      const { previousSteps } = this.state;\n\n      const renderedSteps = previousSteps.map(step => {\n        const { id, message, value, metadata } = step;\n\n        return {\n          id,\n          message,\n          value,\n          metadata\n        };\n      });\n\n      const steps = [];\n\n      for (let i = 0, len = previousSteps.length; i < len; i += 1) {\n        const { id, message, value, metadata } = previousSteps[i];\n\n        steps[id] = {\n          id,\n          message,\n          value,\n          metadata\n        };\n      }\n\n      const values = previousSteps.filter(step => step.value).map(step => step.value);\n\n      handleEnd({ renderedSteps, steps, values });\n    }\n  };\n\n  isInputValueEmpty = () => {\n    const { inputValue } = this.state;\n    return !inputValue || inputValue.length === 0;\n  };\n\n  isLastPosition = step => {\n    const { renderedSteps } = this.state;\n    const { length } = renderedSteps;\n    const stepIndex = renderedSteps.map(s => s.key).indexOf(step.key);\n\n    if (length <= 1 || stepIndex + 1 === length) {\n      return true;\n    }\n\n    const nextStep = renderedSteps[stepIndex + 1];\n    const hasMessage = nextStep.message || nextStep.asMessage;\n\n    if (!hasMessage) {\n      return true;\n    }\n\n    const isLast = step.user !== nextStep.user;\n    return isLast;\n  };\n\n  isFirstPosition = step => {\n    const { renderedSteps } = this.state;\n    const stepIndex = renderedSteps.map(s => s.key).indexOf(step.key);\n\n    if (stepIndex === 0) {\n      return true;\n    }\n\n    const lastStep = renderedSteps[stepIndex - 1];\n    const hasMessage = lastStep.message || lastStep.asMessage;\n\n    if (!hasMessage) {\n      return true;\n    }\n\n    const isFirst = step.user !== lastStep.user;\n    return isFirst;\n  };\n\n  handleKeyPress = event => {\n    if (event.key === 'Enter') {\n      this.submitUserMessage();\n    }\n  };\n\n  handleSubmitButton = () => {\n    const { speaking, recognitionEnable } = this.state;\n\n    if ((this.isInputValueEmpty() || speaking) && recognitionEnable) {\n      this.recognition.speak();\n      if (!speaking) {\n        this.setState({ speaking: true });\n      }\n      return;\n    }\n\n    this.submitUserMessage();\n  };\n\n  submitUserMessage = () => {\n    const { defaultUserSettings, inputValue, previousSteps, renderedSteps } = this.state;\n    let { currentStep } = this.state;\n\n    const isInvalid = currentStep.validator && this.checkInvalidInput();\n\n    if (!isInvalid) {\n      const step = {\n        message: inputValue,\n        value: inputValue\n      };\n\n      currentStep = Object.assign({}, defaultUserSettings, currentStep, step);\n\n      renderedSteps.push(currentStep);\n      previousSteps.push(currentStep);\n\n      this.setState(\n        {\n          currentStep,\n          renderedSteps,\n          previousSteps,\n          disabled: true,\n          inputValue: ''\n        },\n        () => {\n          if (this.input) {\n            this.input.blur();\n          }\n        }\n      );\n    }\n  };\n\n  checkInvalidInput = () => {\n    const { enableMobileAutoFocus } = this.props;\n    const { currentStep, inputValue } = this.state;\n    const result = currentStep.validator(inputValue);\n    const value = inputValue;\n\n    if (typeof result !== 'boolean' || !result) {\n      this.setState(\n        {\n          inputValue: result.toString(),\n          inputInvalid: true,\n          disabled: true\n        },\n        () => {\n          setTimeout(() => {\n            this.setState(\n              {\n                inputValue: value,\n                inputInvalid: false,\n                disabled: false\n              },\n              () => {\n                if (enableMobileAutoFocus || !isMobile()) {\n                  if (this.input) {\n                    this.input.focus();\n                  }\n                }\n              }\n            );\n          }, 2000);\n        }\n      );\n\n      return true;\n    }\n\n    return false;\n  };\n\n  toggleChatBot = opened => {\n    const { toggleFloating } = this.props;\n\n    if (toggleFloating) {\n      toggleFloating({ opened });\n    } else {\n      this.setState({ opened });\n    }\n  };\n\n  renderStep = (step, index) => {\n    const { renderedSteps } = this.state;\n    const {\n      avatarStyle,\n      bubbleStyle,\n      bubbleOptionStyle,\n      customStyle,\n      hideBotAvatar,\n      hideUserAvatar,\n      speechSynthesis\n    } = this.props;\n    const { options, component, asMessage } = step;\n    const steps = this.generateRenderedStepsById();\n    const previousStep = index > 0 ? renderedSteps[index - 1] : {};\n\n    if (component && !asMessage) {\n      return (\n        <CustomStep\n          key={index}\n          speak={this.speak}\n          step={step}\n          steps={steps}\n          style={customStyle}\n          previousStep={previousStep}\n          previousValue={previousStep.value}\n          triggerNextStep={this.triggerNextStep}\n        />\n      );\n    }\n\n    if (options) {\n      return (\n        <OptionsStep\n          key={index}\n          step={step}\n          previousValue={previousStep.value}\n          triggerNextStep={this.triggerNextStep}\n          bubbleOptionStyle={bubbleOptionStyle}\n        />\n      );\n    }\n\n    return (\n      <TextStep\n        key={index}\n        step={step}\n        steps={steps}\n        speak={this.speak}\n        previousStep={previousStep}\n        previousValue={previousStep.value}\n        triggerNextStep={this.triggerNextStep}\n        avatarStyle={avatarStyle}\n        bubbleStyle={bubbleStyle}\n        hideBotAvatar={hideBotAvatar}\n        hideUserAvatar={hideUserAvatar}\n        speechSynthesis={speechSynthesis}\n        isFirst={this.isFirstPosition(step)}\n        isLast={this.isLastPosition(step)}\n      />\n    );\n  };\n\n  render() {\n    const {\n      currentStep,\n      disabled,\n      inputInvalid,\n      inputValue,\n      opened,\n      renderedSteps,\n      speaking,\n      recognitionEnable\n    } = this.state;\n    const {\n      className,\n      contentStyle,\n      extraControl,\n      controlStyle,\n      floating,\n      floatingIcon,\n      floatingStyle,\n      footerStyle,\n      headerComponent,\n      headerTitle,\n      hideHeader,\n      hideSubmitButton,\n      inputStyle,\n      placeholder,\n      inputAttributes,\n      recognitionPlaceholder,\n      style,\n      submitButtonStyle,\n      width,\n      height\n    } = this.props;\n\n    const header = headerComponent || (\n      <Header className=\"rsc-header\">\n        <HeaderTitle className=\"rsc-header-title\">{headerTitle}</HeaderTitle>\n        {floating && (\n          <HeaderIcon className=\"rsc-header-close-button\" onClick={() => this.toggleChatBot(false)}>\n            <CloseIcon />\n          </HeaderIcon>\n        )}\n      </Header>\n    );\n\n    let customControl;\n    if (extraControl !== undefined) {\n      customControl = React.cloneElement(extraControl, {\n        disabled,\n        speaking,\n        invalid: inputInvalid\n      });\n    }\n\n    const icon =\n      (this.isInputValueEmpty() || speaking) && recognitionEnable ? <MicIcon /> : <SubmitIcon />;\n\n    const inputPlaceholder = speaking\n      ? recognitionPlaceholder\n      : currentStep.placeholder || placeholder;\n\n    const inputAttributesOverride = currentStep.inputAttributes || inputAttributes;\n\n    return (\n      <div className={`rsc ${className}`}>\n        {floating && (\n          <FloatButton\n            className=\"rsc-float-button\"\n            style={floatingStyle}\n            opened={opened}\n            onClick={() => this.toggleChatBot(true)}\n          >\n            {typeof floatingIcon === 'string' ? <FloatingIcon src={floatingIcon} /> : floatingIcon}\n          </FloatButton>\n        )}\n        <ChatBotContainer\n          className=\"rsc-container\"\n          floating={floating}\n          floatingStyle={floatingStyle}\n          opened={opened}\n          style={style}\n          width={width}\n          height={height}\n        >\n          {!hideHeader && header}\n          <Content\n            className=\"rsc-content\"\n            ref={this.setContentRef}\n            floating={floating}\n            style={contentStyle}\n            height={height}\n            hideInput={currentStep.hideInput}\n          >\n            {renderedSteps.map(this.renderStep)}\n          </Content>\n          <Footer className=\"rsc-footer\" style={footerStyle}>\n            {!currentStep.hideInput && (\n              <Input\n                type=\"textarea\"\n                style={inputStyle}\n                ref={this.setInputRef}\n                className=\"rsc-input\"\n                placeholder={inputInvalid ? '' : inputPlaceholder}\n                onKeyPress={this.handleKeyPress}\n                onChange={this.onValueChange}\n                value={inputValue}\n                floating={floating}\n                invalid={inputInvalid}\n                disabled={disabled}\n                hasButton={!hideSubmitButton}\n                {...inputAttributesOverride}\n              />\n            )}\n            <div style={controlStyle} className=\"rsc-controls\">\n              {!currentStep.hideInput && !currentStep.hideExtraControl && customControl}\n              {!currentStep.hideInput && !hideSubmitButton && (\n                <SubmitButton\n                  className=\"rsc-submit-button\"\n                  style={submitButtonStyle}\n                  onClick={this.handleSubmitButton}\n                  invalid={inputInvalid}\n                  disabled={disabled}\n                  speaking={speaking}\n                >\n                  {icon}\n                </SubmitButton>\n              )}\n            </div>\n          </Footer>\n        </ChatBotContainer>\n      </div>\n    );\n  }\n}\n\nChatBot.propTypes = {\n  avatarStyle: PropTypes.objectOf(PropTypes.any),\n  botAvatar: PropTypes.string,\n  botName: PropTypes.string,\n  botDelay: PropTypes.number,\n  bubbleOptionStyle: PropTypes.objectOf(PropTypes.any),\n  bubbleStyle: PropTypes.objectOf(PropTypes.any),\n  cache: PropTypes.bool,\n  cacheName: PropTypes.string,\n  className: PropTypes.string,\n  contentStyle: PropTypes.objectOf(PropTypes.any),\n  customDelay: PropTypes.number,\n  customStyle: PropTypes.objectOf(PropTypes.any),\n  controlStyle: PropTypes.objectOf(PropTypes.any),\n  enableMobileAutoFocus: PropTypes.bool,\n  enableSmoothScroll: PropTypes.bool,\n  extraControl: PropTypes.objectOf(PropTypes.element),\n  floating: PropTypes.bool,\n  floatingIcon: PropTypes.oneOfType([PropTypes.string, PropTypes.element]),\n  floatingStyle: PropTypes.objectOf(PropTypes.any),\n  footerStyle: PropTypes.objectOf(PropTypes.any),\n  handleEnd: PropTypes.func,\n  headerComponent: PropTypes.element,\n  headerTitle: PropTypes.string,\n  height: PropTypes.string,\n  hideBotAvatar: PropTypes.bool,\n  hideHeader: PropTypes.bool,\n  hideSubmitButton: PropTypes.bool,\n  hideUserAvatar: PropTypes.bool,\n  inputAttributes: PropTypes.objectOf(PropTypes.any),\n  inputStyle: PropTypes.objectOf(PropTypes.any),\n  opened: PropTypes.bool,\n  toggleFloating: PropTypes.func,\n  placeholder: PropTypes.string,\n  recognitionEnable: PropTypes.bool,\n  recognitionLang: PropTypes.string,\n  recognitionPlaceholder: PropTypes.string,\n  speechSynthesis: PropTypes.shape({\n    enable: PropTypes.bool,\n    lang: PropTypes.string,\n    voice:\n      typeof window !== 'undefined'\n        ? PropTypes.instanceOf(window.SpeechSynthesisVoice)\n        : PropTypes.any\n  }),\n  steps: PropTypes.arrayOf(PropTypes.object).isRequired,\n  style: PropTypes.objectOf(PropTypes.any),\n  submitButtonStyle: PropTypes.objectOf(PropTypes.any),\n  userAvatar: PropTypes.string,\n  userDelay: PropTypes.number,\n  width: PropTypes.string\n};\n\nChatBot.defaultProps = {\n  avatarStyle: {},\n  botDelay: 1000,\n  botName: 'The bot',\n  bubbleOptionStyle: {},\n  bubbleStyle: {},\n  cache: false,\n  cacheName: 'rsc_cache',\n  className: '',\n  contentStyle: {},\n  customStyle: {},\n  controlStyle: { position: 'absolute', right: '0', top: '0' },\n  customDelay: 1000,\n  enableMobileAutoFocus: false,\n  enableSmoothScroll: false,\n  extraControl: undefined,\n  floating: false,\n  floatingIcon: <ChatIcon />,\n  floatingStyle: {},\n  footerStyle: {},\n  handleEnd: undefined,\n  headerComponent: undefined,\n  headerTitle: 'Chat',\n  height: '520px',\n  hideBotAvatar: false,\n  hideHeader: false,\n  hideSubmitButton: false,\n  hideUserAvatar: false,\n  inputStyle: {},\n  opened: undefined,\n  placeholder: 'Type the message ...',\n  inputAttributes: {},\n  recognitionEnable: false,\n  recognitionLang: 'en',\n  recognitionPlaceholder: 'Listening ...',\n  speechSynthesis: {\n    enable: false,\n    lang: 'en',\n    voice: null\n  },\n  style: {},\n  submitButtonStyle: {},\n  toggleFloating: undefined,\n  userDelay: 1000,\n  width: '350px',\n  botAvatar:\n    \"data:image/svg+xml,%3csvg version='1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3e%3cpath d='M303 70a47 47 0 1 0-70 40v84h46v-84c14-8 24-23 24-40z' fill='%2393c7ef'/%3e%3cpath d='M256 23v171h23v-84a47 47 0 0 0-23-87z' fill='%235a8bb0'/%3e%3cpath fill='%2393c7ef' d='M0 240h248v124H0z'/%3e%3cpath fill='%235a8bb0' d='M264 240h248v124H264z'/%3e%3cpath fill='%2393c7ef' d='M186 365h140v124H186z'/%3e%3cpath fill='%235a8bb0' d='M256 365h70v124h-70z'/%3e%3cpath fill='%23cce9f9' d='M47 163h419v279H47z'/%3e%3cpath fill='%2393c7ef' d='M256 163h209v279H256z'/%3e%3cpath d='M194 272a31 31 0 0 1-62 0c0-18 14-32 31-32s31 14 31 32z' fill='%233c5d76'/%3e%3cpath d='M380 272a31 31 0 0 1-62 0c0-18 14-32 31-32s31 14 31 32z' fill='%231e2e3b'/%3e%3cpath d='M186 349a70 70 0 1 0 140 0H186z' fill='%233c5d76'/%3e%3cpath d='M256 349v70c39 0 70-31 70-70h-70z' fill='%231e2e3b'/%3e%3c/svg%3e\",\n  userAvatar:\n    \"data:image/svg+xml,%3csvg viewBox='-208.5 21 100 100' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3ccircle cx='-158.5' cy='71' fill='%23F5EEE5' r='50'/%3e%3cdefs%3e%3ccircle cx='-158.5' cy='71' id='a' r='50'/%3e%3c/defs%3e%3cclipPath id='b'%3e%3cuse overflow='visible' xlink:href='%23a'/%3e%3c/clipPath%3e%3cpath clip-path='url(%23b)' d='M-108.5 121v-14s-21.2-4.9-28-6.7c-2.5-.7-7-3.3-7-12V82h-30v6.3c0 8.7-4.5 11.3-7 12-6.8 1.9-28.1 7.3-28.1 6.7v14h100.1z' fill='%23E6C19C'/%3e%3cg clip-path='url(%23b)'%3e%3cdefs%3e%3cpath d='M-108.5 121v-14s-21.2-4.9-28-6.7c-2.5-.7-7-3.3-7-12V82h-30v6.3c0 8.7-4.5 11.3-7 12-6.8 1.9-28.1 7.3-28.1 6.7v14h100.1z' id='c'/%3e%3c/defs%3e%3cclipPath id='d'%3e%3cuse overflow='visible' xlink:href='%23c'/%3e%3c/clipPath%3e%3cpath clip-path='url(%23d)' d='M-158.5 100.1c12.7 0 23-18.6 23-34.4 0-16.2-10.3-24.7-23-24.7s-23 8.5-23 24.7c0 15.8 10.3 34.4 23 34.4z' fill='%23D4B08C'/%3e%3c/g%3e%3cpath d='M-158.5 96c12.7 0 23-16.3 23-31 0-15.1-10.3-23-23-23s-23 7.9-23 23c0 14.7 10.3 31 23 31z' fill='%23F2CEA5'/%3e%3c/svg%3e\"\n};\n\nexport default ChatBot;\n"]},"metadata":{},"sourceType":"module"}