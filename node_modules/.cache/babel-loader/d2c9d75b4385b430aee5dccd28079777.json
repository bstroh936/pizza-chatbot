{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\TheTOP\\\\Documents\\\\GitHub\\\\pizza-chatbot-chk4\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\TheTOP\\\\Documents\\\\GitHub\\\\pizza-chatbot-chk4\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:\\\\Users\\\\TheTOP\\\\Documents\\\\GitHub\\\\pizza-chatbot-chk4\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\Users\\\\TheTOP\\\\Documents\\\\GitHub\\\\pizza-chatbot-chk4\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\TheTOP\\\\Documents\\\\GitHub\\\\pizza-chatbot-chk4\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from'react';import'../css/OrderStyle.css';import StepFactory from'./StepFactory';var OrderStep=/*#__PURE__*/function(_React$Component){_inherits(OrderStep,_React$Component);var _super=_createSuper(OrderStep);function OrderStep(props){var _this;_classCallCheck(this,OrderStep);_this=_super.call(this,props);_this.state={selected:[],items:[],curKey:'',trigger:false};_this.triggerNext=_this.triggerNext.bind(_assertThisInitialized(_this));_this.onSelect=_this.onSelect.bind(_assertThisInitialized(_this));return _this;}_createClass(OrderStep,[{key:\"checkSpecialInstr\",value:function checkSpecialInstr(){var chk=this.props.steps.hasOwnProperty('specialinstmsg');var strchk=this.props.steps.hasOwnProperty('specialinstentry');if(strchk){return this.props.steps.specialinstentry.value;}else if(chk){return'noentry';}return'';}},{key:\"checkRequiredInput\",value:function checkRequiredInput(val){if((val.ownerName==='crusts'||val.ownerName==='sizes')&&this.state.selected.length===0){var trig=val.trigger==='remove'||val.trigger==='cancel'?true:false;return trig;}return true;}},{key:\"triggerNext\",value:function triggerNext(val){var _this2=this;if(!this.checkRequiredInput(val)){alert(\"You must select one of the available \".concat(val.ownerName));return null;}var ordercontrol=this.props.step.metadata;//update order\nvar selectedObjs=this.state.selected;var processObj={action:val,selections:selectedObjs};var processingResults=ordercontrol.ProcessAction(processObj);var msg=processingResults.msg;switch(processingResults.trigger){case'cancel'://cancel order\nbreak;case'remove'://remove pizza\nbreak;default:this.props.step.trigger=processingResults.trigger;}//trigger next step in chatbot\nvar type=\"\".concat(val.trigger,\":\").concat(val.actionType,\"(\").concat(val.ownerType,\":\").concat(val.ownerName,\"=>\").concat(val.targetType,\":\").concat(val.targetName,\")\");var key=this.props.step.key;this.props.step.metadata.botKey=key;if(key!==this.state.curKey){this.setState({curKey:key});this.props.step.id=key;var newsteps=this.props.steps.pizzabuilder;newsteps.id=key;delete this.props.steps.pizzabuilder;this.props.steps[key]=newsteps;}var data={preserveMsg:true,stepMsg:ordercontrol.stepMsg,value:selectedObjs,type:type,msg:msg};if(val.targetType==='special'&&val.actionType==='next'){ordercontrol.handleSpecialInst=true;this.props.step.trigger=val.targetName;}this.setState({selected:[],trigger:true,curKey:''},function(){_this2.props.triggerNextStep(data);});}},{key:\"onSelect\",value:function onSelect(val){var currrentlySelected=this.props.step.metadata.HandleItemSelect(val);this.setState({selected:currrentlySelected});}},{key:\"render\",value:function render(){var ordercontrol=this.props.step.metadata;if(!ordercontrol.isStarted){var name=this.props.steps.ordername.value;ordercontrol.isStarted=name;}else if(ordercontrol.handleSpecialInst){var inst=this.checkSpecialInstr();ordercontrol.specialInstructions=inst;}if(ordercontrol.IsSpecialStep){return/*#__PURE__*/React.createElement(BuildSpecialStep,{stepInfo:ordercontrol.SpecialStep,onTrigger:this.triggerNext});}var getStepType=function getStepType(val){if(val.IsSpecialStep)return'specialStep';switch(val.currentStepInfo.currentStep.type){case'review':return'reviewStep';case'edit':return val.currentStepInfo.currentStep.name==='order'?'editOrderStep':'editStep';default:return'standard';}};var currentStep=ordercontrol.StepInfo();var stepCtrls=StepFactory(currentStep);var buildType=getStepType(ordercontrol);return/*#__PURE__*/React.createElement(BuildStep,{ordercontrol:ordercontrol,stepCtrls:stepCtrls,stepType:buildType,selected:this.state.selected,onTrigger:this.triggerNext,onSelect:this.onSelect});}}]);return OrderStep;}(React.Component);function BuildStep(props){var buildType=props.stepType;var stepMsg=props.ordercontrol.StepMsg();switch(buildType){case'specialStep':return/*#__PURE__*/React.createElement(BuildSpecialStep,{stepInfo:props.ordercontrol.SpecialStep,onTrigger:props.onTrigger});case'reviewStep':return/*#__PURE__*/React.createElement(BuildReviewStep,{reviewType:props.ordercontrol.currentStepInfo.currentStep.name,pizzaOrder:props.ordercontrol.pizzaOrder,stepCtrls:props.stepCtrls,onTrigger:props.onTrigger});case'editOrderStep':return null;default:var stepProcesingInfo=props.ordercontrol.CurrentStep();return/*#__PURE__*/React.createElement(BuildStandardStep,{displayMsg:stepMsg,stepOptions:stepProcesingInfo,selected:props.selected,stepCtrls:props.stepCtrls,onTrigger:props.onTrigger,onSelect:props.onSelect});}}function BuildSpecialStep(props){var stepMsg=/*#__PURE__*/React.createElement(\"div\",{className:\"orderStepMsg\"},props.stepInfo.stepMsg);var controlArray=/*#__PURE__*/React.createElement(ControlArray,{stepCtrls:props.stepInfo.stepCtrls,onTrigger:props.onTrigger});var stepClassName=\"orderstep-\".concat(props.stepInfo.msgClass);return/*#__PURE__*/React.createElement(\"div\",{className:stepClassName},stepMsg,controlArray);}function BuildReviewStep(props){var reviewType=props.reviewType;if(reviewType==='pizza'){var id=props.pizzaOrder.CurrentPizzaID;var retclass=\"review-pizza-\".concat(id);var topMsg=\"Summary for Pizza #\".concat(id);var reviewStr=props.pizzaOrder.CurrentPizzaString;var controlArray=/*#__PURE__*/React.createElement(ControlArray,{stepCtrls:props.stepCtrls,onTrigger:props.onTrigger});return/*#__PURE__*/React.createElement(\"div\",{className:\"pizzaReviewMsg\"},/*#__PURE__*/React.createElement(\"div\",{className:\"pizzaIDmsg\"},topMsg),/*#__PURE__*/React.createElement(\"div\",{className:retclass},reviewStr),controlArray);}}function BuildStandardStep(props){var stepOptions=props.stepOptions,stepCtrls=props.stepCtrls;var hasElements=stepOptions.hasMenuElements;var stepMsg=props.displayMsg!==''?/*#__PURE__*/React.createElement(\"div\",{className:\"orderStepMsg\"},props.displayMsg):null;var elementArray=hasElements?/*#__PURE__*/React.createElement(ElementArray,{stepInfo:stepOptions.elements,selected:props.selected,onSelect:props.onSelect}):null;var controlArray=/*#__PURE__*/React.createElement(ControlArray,{stepCtrls:stepCtrls,onTrigger:props.onTrigger});var stepClassName=\"orderstep-\".concat(stepOptions.curStepType,\"-\").concat(stepOptions.stepName);return/*#__PURE__*/React.createElement(\"div\",{className:stepClassName},stepMsg,elementArray,controlArray);}function ElementArray(props){var elements=props.stepInfo.elements;var hasRows=props.stepInfo.hasRows;var hasMulti=props.stepInfo.hasMulti;var click=props.onSelect;var sel=props.selected;return/*#__PURE__*/React.createElement(\"ul\",{className:\"menuEleList\"},hasRows?elements.map(function(e){var rowName=e.name;var rowClass=e.rClass;var rowKey=\"\".concat(rowClass,\"-\").concat(rowName);var rowBtns=e.btns.map(function(b){var key=b.listKey;var i=sel.findIndex(function(p){return p===key;});var capt=b.btnCapt;var val={itemInfo:b.itemInfo,multi:hasMulti};var eleClass=i===-1?b.btnClass:'btn-select';return/*#__PURE__*/React.createElement(\"li\",{key:key,className:eleClass},/*#__PURE__*/React.createElement(\"button\",{className:\"menuBtn\",onClick:function onClick(){return click(val);}},capt));});return/*#__PURE__*/React.createElement(\"div\",{className:rowClass,key:rowKey},/*#__PURE__*/React.createElement(\"div\",{className:\"rowTitle\"},rowName),/*#__PURE__*/React.createElement(\"div\",{className:\"rowBtns\"},rowBtns));}):elements.map(function(e){var capt=e.btnCapt;var key=e.listKey;var val={itemInfo:e.itemInfo,multi:hasMulti};var i=sel.findIndex(function(p){return p===key;});var eleClass=i===-1?e.btnClass:'btn-select';return/*#__PURE__*/React.createElement(\"li\",{key:key,className:eleClass},/*#__PURE__*/React.createElement(\"button\",{className:\"menuBtn\",onClick:function onClick(){return click(val);}},capt));}));}function ControlArray(props){var stepControls=props.stepCtrls.map(function(s){if(s===null)return null;var capt=s.btnCapt;var btnClass=s.btnClss;var key=s.listKey;var ret={ownerType:s.ownerType,ownerName:s.ownerName,targetType:s.targetType,targetName:s.targetName,actionType:s.action,hasSpecial:s.hasSpecial,trigger:s.trigger};return/*#__PURE__*/React.createElement(\"li\",{key:key,className:btnClass},/*#__PURE__*/React.createElement(\"button\",{className:\"ctrlBtn\",onClick:function onClick(){return props.onTrigger(ret);}},capt));});return/*#__PURE__*/React.createElement(\"div\",{className:\"btnNavigationArray\"},/*#__PURE__*/React.createElement(\"ul\",{className:\"btnCtrlList\"},stepControls));}export default OrderStep;","map":{"version":3,"sources":["C:/Users/TheTOP/Documents/GitHub/pizza-chatbot-chk4/src/components/OrderStep.jsx"],"names":["React","StepFactory","OrderStep","props","state","selected","items","curKey","trigger","triggerNext","bind","onSelect","chk","steps","hasOwnProperty","strchk","specialinstentry","value","val","ownerName","length","trig","checkRequiredInput","alert","ordercontrol","step","metadata","selectedObjs","processObj","action","selections","processingResults","ProcessAction","msg","type","actionType","ownerType","targetType","targetName","key","botKey","setState","id","newsteps","pizzabuilder","data","preserveMsg","stepMsg","handleSpecialInst","triggerNextStep","currrentlySelected","HandleItemSelect","isStarted","name","ordername","inst","checkSpecialInstr","specialInstructions","IsSpecialStep","SpecialStep","getStepType","currentStepInfo","currentStep","StepInfo","stepCtrls","buildType","Component","BuildStep","stepType","StepMsg","onTrigger","pizzaOrder","stepProcesingInfo","CurrentStep","BuildSpecialStep","stepInfo","controlArray","stepClassName","msgClass","BuildReviewStep","reviewType","CurrentPizzaID","retclass","topMsg","reviewStr","CurrentPizzaString","BuildStandardStep","stepOptions","hasElements","hasMenuElements","displayMsg","elementArray","elements","curStepType","stepName","ElementArray","hasRows","hasMulti","click","sel","map","e","rowName","rowClass","rClass","rowKey","rowBtns","btns","b","listKey","i","findIndex","p","capt","btnCapt","itemInfo","multi","eleClass","btnClass","ControlArray","stepControls","s","btnClss","ret","hasSpecial"],"mappings":"o4BAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAO,uBAAP,CACA,MAAOC,CAAAA,WAAP,KAAwB,eAAxB,C,GAEMC,CAAAA,S,kHACJ,mBAAYC,KAAZ,CAAkB,2CAChB,uBAAMA,KAAN,EACA,MAAKC,KAAL,CAAW,CACTC,QAAQ,CAAC,EADA,CAETC,KAAK,CAAC,EAFG,CAGTC,MAAM,CAAE,EAHC,CAITC,OAAO,CAAE,KAJA,CAAX,CAOA,MAAKC,WAAL,CAAmB,MAAKA,WAAL,CAAiBC,IAAjB,+BAAnB,CACA,MAAKC,QAAL,CAAgB,MAAKA,QAAL,CAAcD,IAAd,+BAAhB,CAVgB,aAWjB,C,mFACkB,CACjB,GAAME,CAAAA,GAAG,CAAG,KAAKT,KAAL,CAAWU,KAAX,CAAiBC,cAAjB,CAAgC,gBAAhC,CAAZ,CACA,GAAMC,CAAAA,MAAM,CAAG,KAAKZ,KAAL,CAAWU,KAAX,CAAiBC,cAAjB,CAAgC,kBAAhC,CAAf,CACA,GAAIC,MAAJ,CAAW,CACT,MAAO,MAAKZ,KAAL,CAAWU,KAAX,CAAiBG,gBAAjB,CAAkCC,KAAzC,CACD,CAFD,IAEO,IAAIL,GAAJ,CAAQ,CACb,MAAO,SAAP,CACD,CACD,MAAO,EAAP,CACD,C,8DACkBM,G,CAAI,CACrB,GAAG,CAACA,GAAG,CAACC,SAAJ,GAAgB,QAAhB,EAA0BD,GAAG,CAACC,SAAJ,GAAgB,OAA3C,GAAqD,KAAKf,KAAL,CAAWC,QAAX,CAAoBe,MAApB,GAA6B,CAArF,CAAuF,CACrF,GAAMC,CAAAA,IAAI,CAAIH,GAAG,CAACV,OAAJ,GAAc,QAAd,EAAwBU,GAAG,CAACV,OAAJ,GAAc,QAAvC,CAAiD,IAAjD,CAAsD,KAAnE,CACA,MAAOa,CAAAA,IAAP,CACD,CACD,MAAO,KAAP,CACD,C,gDACWH,G,CAAI,iBACd,GAAG,CAAC,KAAKI,kBAAL,CAAwBJ,GAAxB,CAAJ,CAAiC,CAC/BK,KAAK,gDAAyCL,GAAG,CAACC,SAA7C,EAAL,CACA,MAAO,KAAP,CACD,CACD,GAAMK,CAAAA,YAAY,CAAG,KAAKrB,KAAL,CAAWsB,IAAX,CAAgBC,QAArC,CAEA;AACA,GAAMC,CAAAA,YAAY,CAAG,KAAKvB,KAAL,CAAWC,QAAhC,CACA,GAAMuB,CAAAA,UAAU,CAAG,CAACC,MAAM,CAACX,GAAR,CAAaY,UAAU,CAACH,YAAxB,CAAnB,CACA,GAAMI,CAAAA,iBAAiB,CAAGP,YAAY,CAACQ,aAAb,CAA2BJ,UAA3B,CAA1B,CACA,GAAMK,CAAAA,GAAG,CAAGF,iBAAiB,CAACE,GAA9B,CACA,OAAOF,iBAAiB,CAACvB,OAAzB,EACE,IAAK,QAAL,CACE;AAEA,MACF,IAAK,QAAL,CACE;AAEA,MACF,QACE,KAAKL,KAAL,CAAWsB,IAAX,CAAgBjB,OAAhB,CAAyBuB,iBAAiB,CAACvB,OAA3C,CAVJ,CAYA;AACA,GAAM0B,CAAAA,IAAI,WAAMhB,GAAG,CAACV,OAAV,aAAqBU,GAAG,CAACiB,UAAzB,aAAuCjB,GAAG,CAACkB,SAA3C,aAAwDlB,GAAG,CAACC,SAA5D,cAA0ED,GAAG,CAACmB,UAA9E,aAA4FnB,GAAG,CAACoB,UAAhG,KAAV,CACA,GAAMC,CAAAA,GAAG,CAAG,KAAKpC,KAAL,CAAWsB,IAAX,CAAgBc,GAA5B,CACA,KAAKpC,KAAL,CAAWsB,IAAX,CAAgBC,QAAhB,CAAyBc,MAAzB,CAAkCD,GAAlC,CACA,GAAGA,GAAG,GAAG,KAAKnC,KAAL,CAAWG,MAApB,CAA2B,CACzB,KAAKkC,QAAL,CAAc,CAAClC,MAAM,CAACgC,GAAR,CAAd,EACA,KAAKpC,KAAL,CAAWsB,IAAX,CAAgBiB,EAAhB,CAAqBH,GAArB,CACA,GAAMI,CAAAA,QAAQ,CAAG,KAAKxC,KAAL,CAAWU,KAAX,CAAiB+B,YAAlC,CACAD,QAAQ,CAACD,EAAT,CAAcH,GAAd,CACA,MAAO,MAAKpC,KAAL,CAAWU,KAAX,CAAiB+B,YAAxB,CACA,KAAKzC,KAAL,CAAWU,KAAX,CAAiB0B,GAAjB,EAAsBI,QAAtB,CACD,CACD,GAAME,CAAAA,IAAI,CAAG,CACXC,WAAW,CAAC,IADD,CAEXC,OAAO,CAAEvB,YAAY,CAACuB,OAFX,CAGX9B,KAAK,CAACU,YAHK,CAIXO,IAAI,CAACA,IAJM,CAKXD,GAAG,CAACA,GALO,CAAb,CAOA,GAAGf,GAAG,CAACmB,UAAJ,GAAiB,SAAjB,EAA4BnB,GAAG,CAACiB,UAAJ,GAAiB,MAAhD,CAAuD,CACrDX,YAAY,CAACwB,iBAAb,CAAgC,IAAhC,CACA,KAAK7C,KAAL,CAAWsB,IAAX,CAAgBjB,OAAhB,CAA0BU,GAAG,CAACoB,UAA9B,CACD,CACD,KAAKG,QAAL,CAAc,CAACpC,QAAQ,CAAC,EAAV,CAAaG,OAAO,CAAE,IAAtB,CAA4BD,MAAM,CAAC,EAAnC,CAAd,CAAsD,UAAM,CAC1D,MAAI,CAACJ,KAAL,CAAW8C,eAAX,CAA2BJ,IAA3B,EACD,CAFD,EAGD,C,0CACQ3B,G,CAAI,CACX,GAAMgC,CAAAA,kBAAkB,CAAG,KAAK/C,KAAL,CAAWsB,IAAX,CAAgBC,QAAhB,CAAyByB,gBAAzB,CAA0CjC,GAA1C,CAA3B,CACA,KAAKuB,QAAL,CAAc,CAACpC,QAAQ,CAAC6C,kBAAV,CAAd,EACD,C,uCACO,CACN,GAAM1B,CAAAA,YAAY,CAAG,KAAKrB,KAAL,CAAWsB,IAAX,CAAgBC,QAArC,CACA,GAAG,CAACF,YAAY,CAAC4B,SAAjB,CAA2B,CACzB,GAAMC,CAAAA,IAAI,CAAG,KAAKlD,KAAL,CAAWU,KAAX,CAAiByC,SAAjB,CAA2BrC,KAAxC,CACAO,YAAY,CAAC4B,SAAb,CAAyBC,IAAzB,CACD,CAHD,IAGO,IAAG7B,YAAY,CAACwB,iBAAhB,CAAkC,CACvC,GAAMO,CAAAA,IAAI,CAAG,KAAKC,iBAAL,EAAb,CAEAhC,YAAY,CAACiC,mBAAb,CAAmCF,IAAnC,CACD,CACD,GAAG/B,YAAY,CAACkC,aAAhB,CAA8B,CAC5B,mBAAO,oBAAC,gBAAD,EAAkB,QAAQ,CAAElC,YAAY,CAACmC,WAAzC,CAAsD,SAAS,CAAE,KAAKlD,WAAtE,EAAP,CACD,CAED,GAAMmD,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAAC1C,GAAD,CAAS,CAC3B,GAAGA,GAAG,CAACwC,aAAP,CAAsB,MAAO,aAAP,CACtB,OAAQxC,GAAG,CAAC2C,eAAJ,CAAoBC,WAApB,CAAgC5B,IAAxC,EACE,IAAK,QAAL,CACE,MAAO,YAAP,CACF,IAAK,MAAL,CACE,MAAOhB,CAAAA,GAAG,CAAC2C,eAAJ,CAAoBC,WAApB,CAAgCT,IAAhC,GAAuC,OAAvC,CAA+C,eAA/C,CAA+D,UAAtE,CACF,QACE,MAAO,UAAP,CANJ,CAQD,CAVD,CAWA,GAAMS,CAAAA,WAAW,CAAGtC,YAAY,CAACuC,QAAb,EAApB,CACA,GAAMC,CAAAA,SAAS,CAAG/D,WAAW,CAAC6D,WAAD,CAA7B,CAEA,GAAMG,CAAAA,SAAS,CAAGL,WAAW,CAACpC,YAAD,CAA7B,CACA,mBAAO,oBAAC,SAAD,EAAW,YAAY,CAAEA,YAAzB,CAAuC,SAAS,CAAEwC,SAAlD,CAA6D,QAAQ,CAAEC,SAAvE,CAAkF,QAAQ,CAAE,KAAK7D,KAAL,CAAWC,QAAvG,CAAkH,SAAS,CAAE,KAAKI,WAAlI,CAA+I,QAAQ,CAAE,KAAKE,QAA9J,EAAP,CACD,C,uBAnHqBX,KAAK,CAACkE,S,EAqH9B,QAASC,CAAAA,SAAT,CAAmBhE,KAAnB,CAAyB,CACvB,GAAM8D,CAAAA,SAAS,CAAG9D,KAAK,CAACiE,QAAxB,CACA,GAAMrB,CAAAA,OAAO,CAAG5C,KAAK,CAACqB,YAAN,CAAmB6C,OAAnB,EAAhB,CACA,OAAQJ,SAAR,EACE,IAAK,aAAL,CACE,mBAAO,oBAAC,gBAAD,EAAkB,QAAQ,CAAE9D,KAAK,CAACqB,YAAN,CAAmBmC,WAA/C,CAA4D,SAAS,CAAExD,KAAK,CAACmE,SAA7E,EAAP,CACF,IAAK,YAAL,CACA,mBAAO,oBAAC,eAAD,EAAiB,UAAU,CAAEnE,KAAK,CAACqB,YAAN,CAAmBqC,eAAnB,CAAmCC,WAAnC,CAA+CT,IAA5E,CAAkF,UAAU,CAAElD,KAAK,CAACqB,YAAN,CAAmB+C,UAAjH,CAA6H,SAAS,CAAEpE,KAAK,CAAC6D,SAA9I,CAAyJ,SAAS,CAAE7D,KAAK,CAACmE,SAA1K,EAAP,CACA,IAAK,eAAL,CACE,MAAO,KAAP,CACF,QACE,GAAME,CAAAA,iBAAiB,CAAGrE,KAAK,CAACqB,YAAN,CAAmBiD,WAAnB,EAA1B,CACA,mBAAO,oBAAC,iBAAD,EAAmB,UAAU,CAAE1B,OAA/B,CAAwC,WAAW,CAAEyB,iBAArD,CAAwE,QAAQ,CAAErE,KAAK,CAACE,QAAxF,CAAkG,SAAS,CAAEF,KAAK,CAAC6D,SAAnH,CAA8H,SAAS,CAAE7D,KAAK,CAACmE,SAA/I,CAA0J,QAAQ,CAAEnE,KAAK,CAACQ,QAA1K,EAAP,CATJ,CAWD,CACD,QAAS+D,CAAAA,gBAAT,CAA0BvE,KAA1B,CAAgC,CAC9B,GAAM4C,CAAAA,OAAO,cAAG,2BAAK,SAAS,CAAC,cAAf,EAA+B5C,KAAK,CAACwE,QAAN,CAAe5B,OAA9C,CAAhB,CACA,GAAM6B,CAAAA,YAAY,cAAG,oBAAC,YAAD,EAAc,SAAS,CAAEzE,KAAK,CAACwE,QAAN,CAAeX,SAAxC,CAAmD,SAAS,CAAE7D,KAAK,CAACmE,SAApE,EAArB,CACA,GAAMO,CAAAA,aAAa,qBAAgB1E,KAAK,CAACwE,QAAN,CAAeG,QAA/B,CAAnB,CACA,mBACE,2BAAK,SAAS,CAAED,aAAhB,EACG9B,OADH,CAEG6B,YAFH,CADF,CAMD,CACD,QAASG,CAAAA,eAAT,CAAyB5E,KAAzB,CAA+B,CAC7B,GAAM6E,CAAAA,UAAU,CAAG7E,KAAK,CAAC6E,UAAzB,CACA,GAAGA,UAAU,GAAG,OAAhB,CAAwB,CACtB,GAAMtC,CAAAA,EAAE,CAAGvC,KAAK,CAACoE,UAAN,CAAiBU,cAA5B,CACA,GAAMC,CAAAA,QAAQ,wBAAmBxC,EAAnB,CAAd,CACA,GAAMyC,CAAAA,MAAM,8BAAyBzC,EAAzB,CAAZ,CACA,GAAM0C,CAAAA,SAAS,CAAGjF,KAAK,CAACoE,UAAN,CAAiBc,kBAAnC,CACA,GAAMT,CAAAA,YAAY,cAAG,oBAAC,YAAD,EAAc,SAAS,CAAEzE,KAAK,CAAC6D,SAA/B,CAA0C,SAAS,CAAE7D,KAAK,CAACmE,SAA3D,EAArB,CACA,mBACE,2BAAK,SAAS,CAAC,gBAAf,eACE,2BAAK,SAAS,CAAC,YAAf,EAA6Ba,MAA7B,CADF,cAEE,2BAAK,SAAS,CAAED,QAAhB,EAA2BE,SAA3B,CAFF,CAGGR,YAHH,CADF,CAOD,CACF,CACD,QAASU,CAAAA,iBAAT,CAA2BnF,KAA3B,CAAiC,IACxBoF,CAAAA,WADwB,CACEpF,KADF,CACxBoF,WADwB,CACXvB,SADW,CACE7D,KADF,CACX6D,SADW,CAE/B,GAAMwB,CAAAA,WAAW,CAAGD,WAAW,CAACE,eAAhC,CAEA,GAAM1C,CAAAA,OAAO,CAAG5C,KAAK,CAACuF,UAAN,GAAmB,EAAnB,cAAsB,2BAAK,SAAS,CAAC,cAAf,EAA+BvF,KAAK,CAACuF,UAArC,CAAtB,CAA6E,IAA7F,CACA,GAAMC,CAAAA,YAAY,CAAGH,WAAW,cAC9B,oBAAC,YAAD,EAAc,QAAQ,CAAED,WAAW,CAACK,QAApC,CAA8C,QAAQ,CAAEzF,KAAK,CAACE,QAA9D,CAAwE,QAAQ,CAAEF,KAAK,CAACQ,QAAxF,EAD8B,CAE7B,IAFH,CAGA,GAAMiE,CAAAA,YAAY,cAAG,oBAAC,YAAD,EAAc,SAAS,CAAEZ,SAAzB,CAAoC,SAAS,CAAE7D,KAAK,CAACmE,SAArD,EAArB,CACA,GAAMO,CAAAA,aAAa,qBAAgBU,WAAW,CAACM,WAA5B,aAA2CN,WAAW,CAACO,QAAvD,CAAnB,CACA,mBACE,2BAAK,SAAS,CAAEjB,aAAhB,EACG9B,OADH,CAEG4C,YAFH,CAGGf,YAHH,CADF,CAOD,CACD,QAASmB,CAAAA,YAAT,CAAsB5F,KAAtB,CAA4B,CAC1B,GAAMyF,CAAAA,QAAQ,CAAGzF,KAAK,CAACwE,QAAN,CAAeiB,QAAhC,CACA,GAAMI,CAAAA,OAAO,CAAG7F,KAAK,CAACwE,QAAN,CAAeqB,OAA/B,CACA,GAAMC,CAAAA,QAAQ,CAAG9F,KAAK,CAACwE,QAAN,CAAesB,QAAhC,CACA,GAAMC,CAAAA,KAAK,CAAG/F,KAAK,CAACQ,QAApB,CACA,GAAMwF,CAAAA,GAAG,CAAGhG,KAAK,CAACE,QAAlB,CACA,mBACE,0BAAI,SAAS,CAAC,aAAd,EACC2F,OAAO,CACRJ,QAAQ,CAACQ,GAAT,CAAa,SAACC,CAAD,CAAK,CAChB,GAAMC,CAAAA,OAAO,CAAGD,CAAC,CAAChD,IAAlB,CACA,GAAMkD,CAAAA,QAAQ,CAAGF,CAAC,CAACG,MAAnB,CACA,GAAMC,CAAAA,MAAM,WAAMF,QAAN,aAAkBD,OAAlB,CAAZ,CACA,GAAMI,CAAAA,OAAO,CAAGL,CAAC,CAACM,IAAF,CAAOP,GAAP,CAAW,SAACQ,CAAD,CAAK,CAC9B,GAAMrE,CAAAA,GAAG,CAAGqE,CAAC,CAACC,OAAd,CACA,GAAMC,CAAAA,CAAC,CAAGX,GAAG,CAACY,SAAJ,CAAc,SAAAC,CAAC,QAAEA,CAAAA,CAAC,GAAGzE,GAAN,EAAf,CAAV,CACA,GAAM0E,CAAAA,IAAI,CAAEL,CAAC,CAACM,OAAd,CACA,GAAMhG,CAAAA,GAAG,CAAG,CAACiG,QAAQ,CAACP,CAAC,CAACO,QAAZ,CAAsBC,KAAK,CAACnB,QAA5B,CAAZ,CACA,GAAMoB,CAAAA,QAAQ,CAAIP,CAAC,GAAG,CAAC,CAAL,CAAOF,CAAC,CAACU,QAAT,CAAkB,YAApC,CAEA,mBACE,0BAAI,GAAG,CAAE/E,GAAT,CAAc,SAAS,CAAE8E,QAAzB,eACE,8BAAQ,SAAS,CAAC,SAAlB,CAA4B,OAAO,CAAE,kBAAK,CAAC,MAAOnB,CAAAA,KAAK,CAAChF,GAAD,CAAZ,CAAkB,CAA7D,EAAgE+F,IAAhE,CADF,CADF,CAKD,CAZe,CAAhB,CAaA,mBACE,2BAAK,SAAS,CAAEV,QAAhB,CAA0B,GAAG,CAAEE,MAA/B,eACE,2BAAK,SAAS,CAAC,UAAf,EAA2BH,OAA3B,CADF,cAEE,2BAAK,SAAS,CAAC,SAAf,EACGI,OADH,CAFF,CADF,CAQD,CAzBD,CADQ,CA0BLd,QAAQ,CAACQ,GAAT,CAAa,SAACC,CAAD,CAAK,CACnB,GAAMY,CAAAA,IAAI,CAAGZ,CAAC,CAACa,OAAf,CACA,GAAM3E,CAAAA,GAAG,CAAG8D,CAAC,CAACQ,OAAd,CACA,GAAM3F,CAAAA,GAAG,CAAG,CAACiG,QAAQ,CAACd,CAAC,CAACc,QAAZ,CAAsBC,KAAK,CAACnB,QAA5B,CAAZ,CACA,GAAMa,CAAAA,CAAC,CAAGX,GAAG,CAACY,SAAJ,CAAc,SAAAC,CAAC,QAAEA,CAAAA,CAAC,GAAGzE,GAAN,EAAf,CAAV,CACA,GAAM8E,CAAAA,QAAQ,CAAGP,CAAC,GAAG,CAAC,CAAL,CAAOT,CAAC,CAACiB,QAAT,CAAkB,YAAnC,CAEA,mBACE,0BAAI,GAAG,CAAE/E,GAAT,CAAc,SAAS,CAAE8E,QAAzB,eACE,8BAAQ,SAAS,CAAC,SAAlB,CAA4B,OAAO,CAAE,kBAAK,CAAC,MAAOnB,CAAAA,KAAK,CAAChF,GAAD,CAAZ,CAAkB,CAA7D,EAAgE+F,IAAhE,CADF,CADF,CAKD,CAZE,CA3BH,CADF,CA4CD,CACD,QAASM,CAAAA,YAAT,CAAsBpH,KAAtB,CAA4B,CAC1B,GAAMqH,CAAAA,YAAY,CAAGrH,KAAK,CAAC6D,SAAN,CAAgBoC,GAAhB,CAAoB,SAACqB,CAAD,CAAK,CAC5C,GAAGA,CAAC,GAAG,IAAP,CAAa,MAAO,KAAP,CACb,GAAMR,CAAAA,IAAI,CAAGQ,CAAC,CAACP,OAAf,CACA,GAAMI,CAAAA,QAAQ,CAAGG,CAAC,CAACC,OAAnB,CACA,GAAMnF,CAAAA,GAAG,CAAGkF,CAAC,CAACZ,OAAd,CACA,GAAMc,CAAAA,GAAG,CAAG,CACVvF,SAAS,CAAEqF,CAAC,CAACrF,SADH,CAEVjB,SAAS,CAAEsG,CAAC,CAACtG,SAFH,CAGVkB,UAAU,CAAEoF,CAAC,CAACpF,UAHJ,CAIVC,UAAU,CAAEmF,CAAC,CAACnF,UAJJ,CAKVH,UAAU,CAAEsF,CAAC,CAAC5F,MALJ,CAMV+F,UAAU,CAAEH,CAAC,CAACG,UANJ,CAOVpH,OAAO,CAAEiH,CAAC,CAACjH,OAPD,CAAZ,CASA,mBACE,0BAAI,GAAG,CAAE+B,GAAT,CAAc,SAAS,CAAE+E,QAAzB,eACE,8BAAQ,SAAS,CAAC,SAAlB,CAA4B,OAAO,CAAE,kBAAK,CAAC,MAAOnH,CAAAA,KAAK,CAACmE,SAAN,CAAgBqD,GAAhB,CAAP,CAA4B,CAAvE,EAA0EV,IAA1E,CADF,CADF,CAKD,CAnBoB,CAArB,CAoBA,mBACE,2BAAK,SAAS,CAAC,oBAAf,eACE,0BAAI,SAAS,CAAC,aAAd,EACGO,YADH,CADF,CADF,CAOD,CAED,cAAetH,CAAAA,SAAf","sourcesContent":["import React from 'react';\r\nimport '../css/OrderStyle.css';\r\nimport StepFactory from './StepFactory';\r\n\r\nclass OrderStep extends React.Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.state={\r\n      selected:[],\r\n      items:[],\r\n      curKey: '',\r\n      trigger: false,\r\n    }\r\n    \r\n    this.triggerNext = this.triggerNext.bind(this);\r\n    this.onSelect = this.onSelect.bind(this);    \r\n  }  \r\n  checkSpecialInstr(){\r\n    const chk = this.props.steps.hasOwnProperty('specialinstmsg');\r\n    const strchk = this.props.steps.hasOwnProperty('specialinstentry');\r\n    if (strchk){\r\n      return this.props.steps.specialinstentry.value;\r\n    } else if (chk){\r\n      return 'noentry'\r\n    }\r\n    return '';\r\n  }\r\n  checkRequiredInput(val){\r\n    if((val.ownerName==='crusts'||val.ownerName==='sizes')&&this.state.selected.length===0){\r\n      const trig = (val.trigger==='remove'||val.trigger==='cancel')?true:false;      \r\n      return trig;\r\n    }\r\n    return true;\r\n  }\r\n  triggerNext(val){   \r\n    if(!this.checkRequiredInput(val)){\r\n      alert(`You must select one of the available ${val.ownerName}`);\r\n      return null;\r\n    }\r\n    const ordercontrol = this.props.step.metadata;\r\n  \r\n    //update order\r\n    const selectedObjs = this.state.selected;\r\n    const processObj = {action:val, selections:selectedObjs}\r\n    const processingResults = ordercontrol.ProcessAction(processObj);\r\n    const msg = processingResults.msg;\r\n    switch(processingResults.trigger){\r\n      case 'cancel':\r\n        //cancel order\r\n\r\n        break;\r\n      case 'remove':\r\n        //remove pizza\r\n\r\n        break;\r\n      default:        \r\n        this.props.step.trigger =processingResults.trigger\r\n    }    \r\n    //trigger next step in chatbot\r\n    const type = `${val.trigger}:${val.actionType}(${val.ownerType}:${val.ownerName}=>${val.targetType}:${val.targetName})`\r\n    const key = this.props.step.key;\r\n    this.props.step.metadata.botKey = key;\r\n    if(key!==this.state.curKey){\r\n      this.setState({curKey:key});\r\n      this.props.step.id = key;\r\n      const newsteps = this.props.steps.pizzabuilder;\r\n      newsteps.id = key;\r\n      delete this.props.steps.pizzabuilder;\r\n      this.props.steps[key]=newsteps;\r\n    }\r\n    const data = {\r\n      preserveMsg:true,\r\n      stepMsg: ordercontrol.stepMsg,\r\n      value:selectedObjs,\r\n      type:type,\r\n      msg:msg,\r\n    }\r\n    if(val.targetType==='special'&&val.actionType==='next'){\r\n      ordercontrol.handleSpecialInst =true;\r\n      this.props.step.trigger = val.targetName;\r\n    }\r\n    this.setState({selected:[],trigger: true, curKey:''}, () => {\r\n      this.props.triggerNextStep(data);\r\n    });\r\n  }\r\n  onSelect(val){\r\n    const currrentlySelected = this.props.step.metadata.HandleItemSelect(val);\r\n    this.setState({selected:currrentlySelected});      \r\n  }\r\n  render(){\r\n    const ordercontrol = this.props.step.metadata;\r\n    if(!ordercontrol.isStarted){\r\n      const name = this.props.steps.ordername.value;\r\n      ordercontrol.isStarted = name;\r\n    } else if(ordercontrol.handleSpecialInst){\r\n      const inst = this.checkSpecialInstr();\r\n\r\n      ordercontrol.specialInstructions = inst;\r\n    }\r\n    if(ordercontrol.IsSpecialStep){\r\n      return <BuildSpecialStep stepInfo={ordercontrol.SpecialStep} onTrigger={this.triggerNext}/>\r\n    }\r\n\r\n    const getStepType = (val) => {\r\n      if(val.IsSpecialStep) return 'specialStep';\r\n      switch (val.currentStepInfo.currentStep.type){\r\n        case 'review':\r\n          return 'reviewStep';\r\n        case 'edit':\r\n          return val.currentStepInfo.currentStep.name==='order'?'editOrderStep':'editStep';\r\n        default:\r\n          return 'standard';\r\n      }      \r\n    }\r\n    const currentStep = ordercontrol.StepInfo();    \r\n    const stepCtrls = StepFactory(currentStep);\r\n    \r\n    const buildType = getStepType(ordercontrol);\r\n    return <BuildStep ordercontrol={ordercontrol} stepCtrls={stepCtrls} stepType={buildType} selected={this.state.selected}  onTrigger={this.triggerNext} onSelect={this.onSelect}/>;\r\n  }  \r\n}\r\nfunction BuildStep(props){\r\n  const buildType = props.stepType;\r\n  const stepMsg = props.ordercontrol.StepMsg();\r\n  switch (buildType){\r\n    case 'specialStep':\r\n      return <BuildSpecialStep stepInfo={props.ordercontrol.SpecialStep} onTrigger={props.onTrigger}/>\r\n    case 'reviewStep':\r\n    return <BuildReviewStep reviewType={props.ordercontrol.currentStepInfo.currentStep.name} pizzaOrder={props.ordercontrol.pizzaOrder} stepCtrls={props.stepCtrls} onTrigger={props.onTrigger}/>;\r\n    case 'editOrderStep':\r\n      return null;\r\n    default:\r\n      const stepProcesingInfo = props.ordercontrol.CurrentStep();\r\n      return <BuildStandardStep displayMsg={stepMsg} stepOptions={stepProcesingInfo} selected={props.selected} stepCtrls={props.stepCtrls} onTrigger={props.onTrigger} onSelect={props.onSelect}/>;\r\n  }\r\n}\r\nfunction BuildSpecialStep(props){\r\n  const stepMsg = <div className=\"orderStepMsg\">{props.stepInfo.stepMsg}</div>;\r\n  const controlArray = <ControlArray stepCtrls={props.stepInfo.stepCtrls} onTrigger={props.onTrigger}/>\r\n  const stepClassName = `orderstep-${props.stepInfo.msgClass}`;\r\n  return (\r\n    <div className={stepClassName}>\r\n      {stepMsg}     \r\n      {controlArray}\r\n    </div>\r\n  )\r\n}\r\nfunction BuildReviewStep(props){\r\n  const reviewType = props.reviewType;\r\n  if(reviewType==='pizza'){\r\n    const id = props.pizzaOrder.CurrentPizzaID;    \r\n    const retclass = `review-pizza-${id}`;\r\n    const topMsg = `Summary for Pizza #${id}`;\r\n    const reviewStr = props.pizzaOrder.CurrentPizzaString;\r\n    const controlArray = <ControlArray stepCtrls={props.stepCtrls} onTrigger={props.onTrigger}/>\r\n    return (\r\n      <div className=\"pizzaReviewMsg\">\r\n        <div className=\"pizzaIDmsg\">{topMsg}</div>\r\n        <div className={retclass}>{reviewStr}</div>\r\n        {controlArray}\r\n      </div>\r\n    )\r\n  }\r\n}\r\nfunction BuildStandardStep(props){\r\n  const {stepOptions, stepCtrls} = props;\r\n  const hasElements = stepOptions.hasMenuElements;\r\n\r\n  const stepMsg = props.displayMsg!==''?<div className=\"orderStepMsg\">{props.displayMsg}</div>:null;\r\n  const elementArray = hasElements?\r\n    <ElementArray stepInfo={stepOptions.elements} selected={props.selected} onSelect={props.onSelect}/>\r\n    :null;\r\n  const controlArray = <ControlArray stepCtrls={stepCtrls} onTrigger={props.onTrigger}/>\r\n  const stepClassName = `orderstep-${stepOptions.curStepType}-${stepOptions.stepName}`;\r\n  return (\r\n    <div className={stepClassName}>\r\n      {stepMsg}\r\n      {elementArray}\r\n      {controlArray}\r\n    </div>\r\n  )  \r\n}\r\nfunction ElementArray(props){\r\n  const elements = props.stepInfo.elements;\r\n  const hasRows = props.stepInfo.hasRows;\r\n  const hasMulti = props.stepInfo.hasMulti;  \r\n  const click = props.onSelect;\r\n  const sel = props.selected;\r\n  return (\r\n    <ul className=\"menuEleList\">\r\n    {hasRows?    \r\n    elements.map((e)=>{\r\n      const rowName = e.name;\r\n      const rowClass = e.rClass;\r\n      const rowKey = `${rowClass}-${rowName}`;\r\n      const rowBtns = e.btns.map((b)=>{\r\n        const key = b.listKey;\r\n        const i = sel.findIndex(p=>p===key)\r\n        const capt =b.btnCapt;        \r\n        const val = {itemInfo:b.itemInfo, multi:hasMulti};\r\n        const eleClass =  i===-1?b.btnClass:'btn-select';\r\n                \r\n        return (\r\n          <li key={key} className={eleClass}>\r\n            <button className=\"menuBtn\" onClick={()=> {return click(val)}}>{capt}</button>\r\n          </li>\r\n        )\r\n      });\r\n      return (\r\n        <div className={rowClass} key={rowKey}>\r\n          <div className=\"rowTitle\">{rowName}</div>\r\n          <div className=\"rowBtns\">            \r\n            {rowBtns}\r\n          </div>\r\n        </div>\r\n      )\r\n    }):elements.map((e)=>{ \r\n      const capt = e.btnCapt;\r\n      const key = e.listKey;\r\n      const val = {itemInfo:e.itemInfo, multi:hasMulti};\r\n      const i = sel.findIndex(p=>p===key)\r\n      const eleClass = i===-1?e.btnClass:'btn-select';\r\n            \r\n      return (\r\n        <li key={key} className={eleClass}>\r\n          <button className=\"menuBtn\" onClick={()=> {return click(val)}}>{capt}</button>\r\n        </li>\r\n      )\r\n    })\r\n    }\r\n    </ul>    \r\n  )\r\n}\r\nfunction ControlArray(props){\r\n  const stepControls = props.stepCtrls.map((s)=>{\r\n    if(s===null) return null;\r\n    const capt = s.btnCapt;\r\n    const btnClass = s.btnClss;\r\n    const key = s.listKey;\r\n    const ret = {      \r\n      ownerType: s.ownerType,\r\n      ownerName: s.ownerName,\r\n      targetType: s.targetType,\r\n      targetName: s.targetName,\r\n      actionType: s.action,\r\n      hasSpecial: s.hasSpecial,    \r\n      trigger: s.trigger,\r\n    }\r\n    return (\r\n      <li key={key} className={btnClass}>\r\n        <button className=\"ctrlBtn\" onClick={()=> {return props.onTrigger(ret)}}>{capt}</button>\r\n      </li>\r\n    )\r\n  })\r\n  return(\r\n    <div className=\"btnNavigationArray\">\r\n      <ul className=\"btnCtrlList\">\r\n        {stepControls}\r\n      </ul>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default OrderStep;"]},"metadata":{},"sourceType":"module"}